cuda_home: /usr/local/cuda-12.8
torch_include: ['/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include', '/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include']
cutlass_include: /home/less/local/cutlass40/include
running install
running bdist_egg
running egg_info
writing fp8_grouped_gemm.egg-info/PKG-INFO
writing dependency_links to fp8_grouped_gemm.egg-info/dependency_links.txt
writing requirements to fp8_grouped_gemm.egg-info/requires.txt
writing top-level names to fp8_grouped_gemm.egg-info/top_level.txt
reading manifest file 'fp8_grouped_gemm.egg-info/SOURCES.txt'
writing manifest file 'fp8_grouped_gemm.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_ext
building 'fp8_grouped_gemm_cuda' extension
[1/1] c++ -MMD -MF /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/build/temp.linux-x86_64-cpython-312/c4_grouped_gemm.o.d -pthread -B /home/less/.conda/envs/pycutlass/compiler_compat -fno-strict-overflow -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /home/less/.conda/envs/pycutlass/include -fPIC -O2 -isystem /home/less/.conda/envs/pycutlass/include -fPIC -I/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/pybind11/include -I/home/less/local/cutlass40/include -I/usr/local/cuda-12.8/include -I/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include -I/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include -I/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/usr/local/cuda-12.8/include -I/home/less/.conda/envs/pycutlass/include/python3.12 -c -c /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp -o /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/build/temp.linux-x86_64-cpython-312/c4_grouped_gemm.o -O3 -std=c++17 -DCUTLASS_ARCH_MMA_SM100_SUPPORTED -DCUTLASS_ENABLE_TENSOR_CORE_MMA=1 -fPIC -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1018"' -DTORCH_EXTENSION_NAME=fp8_grouped_gemm_cuda
FAILED: /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/build/temp.linux-x86_64-cpython-312/c4_grouped_gemm.o 
c++ -MMD -MF /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/build/temp.linux-x86_64-cpython-312/c4_grouped_gemm.o.d -pthread -B /home/less/.conda/envs/pycutlass/compiler_compat -fno-strict-overflow -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /home/less/.conda/envs/pycutlass/include -fPIC -O2 -isystem /home/less/.conda/envs/pycutlass/include -fPIC -I/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/pybind11/include -I/home/less/local/cutlass40/include -I/usr/local/cuda-12.8/include -I/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include -I/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include -I/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/usr/local/cuda-12.8/include -I/home/less/.conda/envs/pycutlass/include/python3.12 -c -c /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp -o /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/build/temp.linux-x86_64-cpython-312/c4_grouped_gemm.o -O3 -std=c++17 -DCUTLASS_ARCH_MMA_SM100_SUPPORTED -DCUTLASS_ENABLE_TENSOR_CORE_MMA=1 -fPIC -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1018"' -DTORCH_EXTENSION_NAME=fp8_grouped_gemm_cuda
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/fusion/operations.hpp:34,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/fusion/callbacks.hpp:35,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:37,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:4433: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
 4433 |     #pragma unroll
      | 
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:4526: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
 4526 |     #pragma unroll
      | 
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:4619: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
 4619 |     #pragma unroll
      | 
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:4712: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
 4712 |     #pragma unroll
      | 
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:4900: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
 4900 |     #pragma unroll
      | 
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:5007: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
 5007 |     #pragma unroll
      | 
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:5114: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
 5114 |     #pragma unroll
      | 
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:68,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_nosmem.hpp:678: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  678 |       #pragma unroll(UnrollEpiLoop ? NumEpiSubtilesN : 1)
      | 
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_nosmem.hpp:680: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  680 |         #pragma unroll(UnrollEpiLoop ? NumEpiSubtilesM : 1)
      | 
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:70,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_tma_warpspecialized.hpp:818: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  818 |       #pragma unroll(UnrollEpiLoop ? NumEpiSubtilesN : 1)
      | 
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_tma_warpspecialized.hpp:820: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  820 |         #pragma unroll(UnrollEpiLoop ? NumEpiSubtilesM : 1)
      | 
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_tma_warpspecialized.hpp:1174: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
 1174 |     #pragma unroll(UnrollEpiLoop ? NumEpiSubtilesN : 1)
      | 
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_tma_warpspecialized.hpp:1176: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
 1176 |       #pragma unroll(UnrollEpiLoop ? NumEpiSubtilesM : 1)
      | 
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:71,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:866: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  866 |       #pragma unroll(UnrollEpiLoop ? NumEpiSubtilesN : 1)
      | 
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:868: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  868 |         #pragma unroll(UnrollEpiLoop ? NumEpiSubtilesM : 1)
      | 
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:1223: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
 1223 |     #pragma unroll(UnrollEpiLoop ? NumEpiSubtilesN : 1)
      | 
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:1225: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
 1225 |       #pragma unroll(UnrollEpiLoop ? NumEpiSubtilesM : 1)
      | 
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp:34,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/tile_scheduler.hpp:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:34,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/barrier.h:144: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  144 |         #pragma unroll 1
      | 
/home/less/local/cutlass40/include/cutlass/barrier.h:160: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  160 |         #pragma unroll 1
      | 
/home/less/local/cutlass40/include/cutlass/barrier.h:174: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  174 |         #pragma unroll 1
      | 
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/tile_scheduler.hpp:66,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:34,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_group.hpp:341: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  341 |         #pragma unroll
      | 
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_base_streamk.h:139: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  139 |     #pragma unroll 2
      | 
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:483: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  483 |     #pragma unroll(IterationsUnroll ? OutputTileIterator::kIterations : 1)
      | 
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:388: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  388 |     #pragma unroll
      | 
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:61,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_multistage.h:679: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  679 |     #pragma unroll
      | 
In file included from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:57,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h:312: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  312 |       #pragma unroll(IterationsUnroll ? kIterations : 1)
      | 
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h:399: warning: ignoring ‘#pragma unroll ’ [-Wunknown-pragmas]
  399 |       #pragma unroll(IterationsUnroll ? kIterations : 1)
      | 
In file included from /home/less/local/cutlass40/include/cute/atom/mma_atom.hpp:1117,
                 from /home/less/local/cutlass40/include/cute/atom/copy_atom.hpp:39,
                 from /home/less/local/cutlass40/include/cute/algorithm/copy.hpp:36,
                 from /home/less/local/cutlass40/include/cute/tensor.hpp:51,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:8:
/home/less/local/cutlass40/include/cute/atom/mma_traits_sm100.hpp: In function ‘constexpr cute::UMMA::SmemDescriptor cute::UMMA::make_umma_desc(const cute::Tensor<Engine, Layout>&)’:
/home/less/local/cutlass40/include/cute/atom/mma_traits_sm100.hpp:211:9: warning: typedef ‘using value_type = typename TEngine::value_type’ locally defined but not used [-Wunused-local-typedefs]
  211 |   using value_type = typename TEngine::value_type;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cute/atom/copy_atom.hpp:756,
                 from /home/less/local/cutlass40/include/cute/algorithm/copy.hpp:36,
                 from /home/less/local/cutlass40/include/cute/tensor.hpp:51,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:8:
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp: In function ‘constexpr void cute::detail::fill_tma_gmem_shape_stride(const cute::Tensor<Engine, Layout>&, const TmaGmemBasisStride&, cute::array<ShapeT, TmaRank>&, cute::array<long unsigned int, TmaRank>&)’:
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:827:9: warning: typedef ‘using TmaInternalType = typename GEngine::value_type’ locally defined but not used [-Wunused-local-typedefs]
  827 |   using TmaInternalType = typename GEngine::value_type;
      |         ^~~~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cute/tensor.hpp:51,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:8:
/home/less/local/cutlass40/include/cute/algorithm/copy.hpp: In function ‘void cute::copy_if(const cute::AutoCopyAsync&, const PrdTensor&, const cute::Tensor<Engine, Layout>&, cute::Tensor<DEngine, DLayout>&)’:
/home/less/local/cutlass40/include/cute/algorithm/copy.hpp:117:9: warning: typedef ‘using SrcElemWithConst = std::remove_reference_t<typename SrcEngine::reference>’ locally defined but not used [-Wunused-local-typedefs]
  117 |   using SrcElemWithConst = remove_reference_t<typename SrcEngine::reference>;
      |         ^~~~~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cute/tensor.hpp:57,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:8:
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp: In function ‘void cute::detail::epilogue_predication(const cute::ThrMMA<Args ...>&, const Alpha&, cute::Tensor<Engine, Layout>&, const Beta&, cute::Tensor<TB, BLayout>&, cute::Tensor<TSC, SCLayout>&, const CLoadTransformOp&, const CStoreTransformOp&)’:
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:69:9: warning: typedef ‘using InputTypeC = typename TSC::value_type’ locally defined but not used [-Wunused-local-typedefs]
   69 |   using InputTypeC   = typename TSC::value_type;
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp: In function ‘void cute::detail::epilogue_no_predication(uint32_t, const cute::ThrMMA<Args ...>&, const Alpha&, cute::Tensor<Engine, Layout>&, const Beta&, cute::Tensor<TB, BLayout>&, const CLoadTransformOp&, const CStoreTransformOp&, const SmemCopyLdOpC&, const SmemCopyStOpC&)’:
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:120:9: warning: typedef ‘using ComputeTypeC = typename TRC::value_type’ locally defined but not used [-Wunused-local-typedefs]
  120 |   using ComputeTypeC = typename TRC::value_type;
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp: In function ‘void cute::detail::cooperative_gemm_predication(const cute::ThrMMA<Args ...>&, const cute::Tensor<Engine, Layout>&, const cute::Tensor<DEngine, DLayout>&, cute::Tensor<TB, BLayout>&, const ALoadTransformOp&, const BLoadTransformOp&)’:
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:175:9: warning: typedef ‘using InputTypeA = typename TA::value_type’ locally defined but not used [-Wunused-local-typedefs]
  175 |   using InputTypeA        = typename TA::value_type;
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:176:9: warning: typedef ‘using InputTypeB = typename TB::value_type’ locally defined but not used [-Wunused-local-typedefs]
  176 |   using InputTypeB        = typename TB::value_type;
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:177:9: warning: typedef ‘using InputTypeC = typename TC::value_type’ locally defined but not used [-Wunused-local-typedefs]
  177 |   using InputTypeC        = typename TC::value_type;
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:180:9: warning: typedef ‘using ComputeTypeC = typename cute::ThrMMA<Args ...>::ValTypeC’ locally defined but not used [-Wunused-local-typedefs]
  180 |   using ComputeTypeC = typename ThrMMA<Args...>::ValTypeC;
      |         ^~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cute/tensor.hpp:57,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:8:
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp: In function ‘void cute::detail::cooperative_gemm_no_predication(uint32_t, const cute::ThrMMA<Args ...>&, const cute::Tensor<Engine, Layout>&, const cute::Tensor<DEngine, DLayout>&, cute::Tensor<TB, BLayout>&, const ALoadTransformOp&, const BLoadTransformOp&, const SmemCopyOpA&, const SmemCopyOpB&)’:
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:293:9: warning: typedef ‘using InputTypeC = typename TC::value_type’ locally defined but not used [-Wunused-local-typedefs]
  293 |   using InputTypeC        = typename TC::value_type;
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:294:9: warning: typedef ‘using ComputeTypeA = typename cute::ThrMMA<Args ...>::ValTypeA’ locally defined but not used [-Wunused-local-typedefs]
  294 |   using ComputeTypeA = typename ThrMMA<Args...>::ValTypeA;
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:295:9: warning: typedef ‘using ComputeTypeB = typename cute::ThrMMA<Args ...>::ValTypeB’ locally defined but not used [-Wunused-local-typedefs]
  295 |   using ComputeTypeB = typename ThrMMA<Args...>::ValTypeB;
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:296:9: warning: typedef ‘using ComputeTypeC = typename cute::ThrMMA<Args ...>::ValTypeC’ locally defined but not used [-Wunused-local-typedefs]
  296 |   using ComputeTypeC = typename ThrMMA<Args...>::ValTypeC;
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp: In function ‘void cute::cooperative_gemm(uint32_t, const cute::TiledMMA<Args ...>&, const Alpha&, const cute::Tensor<Engine, Layout>&, const cute::Tensor<EngineOut, LayoutOut>&, const Beta&, cute::Tensor<TC, CLayout>&, const ALoadTransformOp&, const BLoadTransformOp&, const CLoadTransformOp&, const CStoreTransformOp&, const SmemCopyOpA&, const SmemCopyOpB&, const SmemCopyLdOpC&, const SmemCopyStOpC&)’:
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:395:9: warning: typedef ‘using InputTypeA = typename TA::value_type’ locally defined but not used [-Wunused-local-typedefs]
  395 |   using InputTypeA        = typename TA::value_type;
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:396:9: warning: typedef ‘using InputTypeB = typename TB::value_type’ locally defined but not used [-Wunused-local-typedefs]
  396 |   using InputTypeB        = typename TB::value_type;
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:397:9: warning: typedef ‘using InputTypeC = typename TC::value_type’ locally defined but not used [-Wunused-local-typedefs]
  397 |   using InputTypeC        = typename TC::value_type;
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:398:9: warning: typedef ‘using ComputeTypeA = typename cute::TiledMMA<Args ...>::ValTypeA’ locally defined but not used [-Wunused-local-typedefs]
  398 |   using ComputeTypeA = typename TiledMMA<Args...>::ValTypeA;
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:399:9: warning: typedef ‘using ComputeTypeB = typename cute::TiledMMA<Args ...>::ValTypeB’ locally defined but not used [-Wunused-local-typedefs]
  399 |   using ComputeTypeB = typename TiledMMA<Args...>::ValTypeB;
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:400:9: warning: typedef ‘using ComputeTypeC = typename cute::TiledMMA<Args ...>::ValTypeC’ locally defined but not used [-Wunused-local-typedefs]
  400 |   using ComputeTypeC = typename TiledMMA<Args...>::ValTypeC;
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp: In function ‘void cute::cooperative_gemm(uint32_t, const cute::TiledMMA<Args ...>&, const cute::Tensor<Engine, Layout>&, const cute::Tensor<DEngine, DLayout>&, cute::Tensor<TB, BLayout>&, const ALoadTransformOp&, const BLoadTransformOp&, const SmemCopyOpA&, const SmemCopyOpB&)’:
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:454:9: warning: typedef ‘using InputTypeA = typename TA::value_type’ locally defined but not used [-Wunused-local-typedefs]
  454 |   using InputTypeA        = typename TA::value_type;
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:455:9: warning: typedef ‘using InputTypeB = typename TB::value_type’ locally defined but not used [-Wunused-local-typedefs]
  455 |   using InputTypeB        = typename TB::value_type;
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:456:9: warning: typedef ‘using InputTypeC = typename TC::value_type’ locally defined but not used [-Wunused-local-typedefs]
  456 |   using InputTypeC        = typename TC::value_type;
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:457:9: warning: typedef ‘using ComputeTypeA = typename cute::TiledMMA<Args ...>::ValTypeA’ locally defined but not used [-Wunused-local-typedefs]
  457 |   using ComputeTypeA = typename TiledMMA<Args...>::ValTypeA;
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:458:9: warning: typedef ‘using ComputeTypeB = typename cute::TiledMMA<Args ...>::ValTypeB’ locally defined but not used [-Wunused-local-typedefs]
  458 |   using ComputeTypeB = typename TiledMMA<Args...>::ValTypeB;
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/algorithm/cooperative_gemm.hpp:459:9: warning: typedef ‘using ComputeTypeC = typename cute::TiledMMA<Args ...>::ValTypeC’ locally defined but not used [-Wunused-local-typedefs]
  459 |   using ComputeTypeC = typename TiledMMA<Args...>::ValTypeC;
      |         ^~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/fusion/operations.hpp:34,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/fusion/callbacks.hpp:35,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:37,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h: In static member function ‘static void cutlass::detail::VectorizedConverter::convert_helper(typename ArrayConverter::result_type&, const typename ArrayConverter::source_type&)’:
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:4309:13: warning: typedef ‘using ElementRes = typename ArrayConverter::result_type::Element’ locally defined but not used [-Wunused-local-typedefs]
 4309 |       using ElementRes = typename ArrayConverter::result_type::Element;
      |             ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h: In static member function ‘static PackedResultType cutlass::NumericArrayConverter<float, signed char, N, Round>::packed_convert(const PackedSrcType&)’:
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:5349:15: error: there are no arguments to ‘__dp4a’ that depend on a template parameter, so a declaration of ‘__dp4a’ must be available [-fpermissive]
 5349 |       t[ii] = __dp4a(x, mask[ii], 0);
      |               ^~~~~~
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:5349:15: note: (if you use ‘-fpermissive’, G++ will accept your code, but allowing the use of an undeclared name is deprecated)
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h: In static member function ‘static PackedResultType cutlass::NumericArrayConverter<float, unsigned char, N, Round>::packed_convert(const PackedSrcType&)’:
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:5423:27: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
 5423 |       result_as_int[ii] = __byte_perm(src_reg, 0x4B000000, prmt_indices[ii]);
      |                           ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h: In static member function ‘static PackedResultType cutlass::NumericArrayConverter<cutlass::half_t, cutlass::integer_subbyte<2, true>, N, Round>::packed_convert(const PackedSrcType&)’:
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:5562:20: error: there are no arguments to ‘__hfma2’ that depend on a template parameter, so a declaration of ‘__hfma2’ must be available [-fpermissive]
 5562 |       fp16x2_val = __hfma2(fp16x2_val,
      |                    ^~~~~~~
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h: In static member function ‘static PackedResultType cutlass::NumericArrayConverter<cutlass::half_t, cutlass::integer_subbyte<2, false>, N, Round>::packed_convert(const PackedSrcType&)’:
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:5698:20: error: there are no arguments to ‘__hfma2’ that depend on a template parameter, so a declaration of ‘__hfma2’ must be available [-fpermissive]
 5698 |       fp16x2_val = __hfma2(fp16x2_val,
      |                    ^~~~~~~
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h: In static member function ‘static PackedResultType cutlass::NumericArrayConverter<cutlass::half_t, cutlass::integer_subbyte<4, true>, N, Round>::packed_convert(const PackedSrcType&)’:
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:5844:20: error: there are no arguments to ‘__hfma2’ that depend on a template parameter, so a declaration of ‘__hfma2’ must be available [-fpermissive]
 5844 |       fp16x2_val = __hfma2(hfma_scale, fp16x2_val, hfma_bias);
      |                    ^~~~~~~
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h: In static member function ‘static PackedResultType cutlass::NumericArrayConverter<cutlass::half_t, cutlass::integer_subbyte<4, false>, N, Round>::packed_convert(const PackedSrcType&)’:
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:5970:22: error: there are no arguments to ‘__hfma2’ that depend on a template parameter, so a declaration of ‘__hfma2’ must be available [-fpermissive]
 5970 |         fp16x2_val = __hfma2(fp16x2_val, reinterpret_cast<const __half2&>(hfma_scale), reinterpret_cast<const __half2&>(hfma_bias));
      |                      ^~~~~~~
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h: In static member function ‘static cutlass::FastNumericArrayConverter<signed char, float, 4, Round>::result_type cutlass::FastNumericArrayConverter<signed char, float, 4, Round>::convert(const source_type&)’:
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:6890:17: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
 6890 |     result[0] = __byte_perm(result[0], result[1], 0x40);
      |                 ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:6891:17: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
 6891 |     result[2] = __byte_perm(result[2], result[3], 0x40);
      |                 ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/numeric_conversion.h:6892:17: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
 6892 |     result[0] = __byte_perm(result[0], result[2], 0x5410);
      |                 ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/pipeline/pipeline.hpp:35,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/detail.hpp:35,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:55,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/pipeline/sm90_pipeline.hpp: In constructor ‘cutlass::PipelineTmaAsync<Stages_>::PipelineTmaAsync(cutlass::PipelineTmaAsync<Stages_>::SharedStorage&, cutlass::PipelineTmaAsync<Stages_>::Params, ClusterShape, InitBarriers, InitMasks)’:
/home/less/local/cutlass40/include/cutlass/pipeline/sm90_pipeline.hpp:333:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  333 |     int thread_idx = threadIdx.x;
      |                      ^~~~~~~~~
      |                      thread_idx
/home/less/local/cutlass40/include/cutlass/pipeline/sm90_pipeline.hpp: In function ‘void cutlass::pipeline_init_wait(int)’:
/home/less/local/cutlass40/include/cutlass/pipeline/sm90_pipeline.hpp:1362:5: error: ‘__syncthreads’ was not declared in this scope
 1362 |     __syncthreads();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/pipeline/sm90_pipeline.hpp: In function ‘void cutlass::pipeline_init_arrive_relaxed(int)’:
/home/less/local/cutlass40/include/cutlass/pipeline/sm90_pipeline.hpp:1375:5: error: ‘__syncthreads’ was not declared in this scope
 1375 |     __syncthreads();
      |     ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/pipeline/pipeline.hpp:36,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/detail.hpp:35,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:55,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/pipeline/sm100_pipeline.hpp: In member function ‘void cutlass::PipelineTmaTransformAsync<Stages_, AtomThrShape_MNK_>::init_masks(ClusterShape, dim3)’:
/home/less/local/cutlass40/include/cutlass/pipeline/sm100_pipeline.hpp:354:24: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  354 |       int thread_idx = threadIdx.x;
      |                        ^~~~~~~~~
      |                        thread_idx
/home/less/local/cutlass40/include/cutlass/pipeline/sm100_pipeline.hpp: At global scope:
/home/less/local/cutlass40/include/cutlass/pipeline/sm100_pipeline.hpp:493:9: error: declaration of ‘using McastDirection = enum class cutlass::McastDirection’ changes meaning of ‘McastDirection’ [-fpermissive]
  493 |   using McastDirection = McastDirection;
      |         ^~~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/pipeline/pipeline.hpp:36,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/detail.hpp:35,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:55,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/pipeline/sm100_pipeline.hpp:48:12: note: ‘McastDirection’ declared here as ‘enum class cutlass::McastDirection’
   48 | enum class McastDirection {
      |            ^~~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:63,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm70_epilogue_vectorized.hpp: In lambda function:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm70_epilogue_vectorized.hpp:298:32: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  298 |     auto synchronize = [] () { __syncthreads(); };
      |                                ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:64,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm70_epilogue_vectorized_array.hpp: In lambda function:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm70_epilogue_vectorized_array.hpp:204:32: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  204 |     auto synchronize = [] () { __syncthreads(); };
      |                                ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_callbacks_tma_warpspecialized.hpp:46,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/sm90_epilogue_tma_warpspecialized.hpp:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:65,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_store_tma_warpspecialized.hpp: In member function ‘void cutlass::epilogue::fusion::Sm90RowReduction<RegReduceFn, ShuffleReduceFn, GmemReduceFn, Stages, CtaTileShapeMNK, ElementOutput, ElementCompute, RoundStyle, StrideMNL, Alignment, EnableNullptr, FinalReduction, VisitCheckOOB, RegReduceSeq>::ConsumerStoreCallbacks<ArgsTuple>::reduce(STensor&&, const SyncFn&, int, int, bool, VTensor)’:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_store_tma_warpspecialized.hpp:1101:9: error: there are no arguments to ‘__threadfence’ that depend on a template parameter, so a declaration of ‘__threadfence’ must be available [-fpermissive]
 1101 |         __threadfence();
      |         ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_store_tma_warpspecialized.hpp: In member function ‘void cutlass::epilogue::fusion::Sm90ColReduction<RegReduceFn, ShuffleReduceFn, GmemReduceFn, Stages, CtaTileShapeMNK, ElementOutput, ElementCompute, RoundStyle, StrideMNL, Alignment, EnableNullptr, FinalReduction, VisitCheckOOB>::ConsumerStoreCallbacks<ArgsTuple>::reduce(STensor&&, const SyncFn&, int, int, bool, VTensor)’:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_store_tma_warpspecialized.hpp:1577:9: error: there are no arguments to ‘__threadfence’ that depend on a template parameter, so a declaration of ‘__threadfence’ must be available [-fpermissive]
 1577 |         __threadfence();
      |         ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_callbacks_tma_warpspecialized.hpp:47,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/sm90_epilogue_tma_warpspecialized.hpp:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:65,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_compute_tma_warpspecialized.hpp: In member function ‘void cutlass::epilogue::fusion::Sm90TreeVisitor<cutlass::epilogue::fusion::Sm90Compute<Activation, ElementOutput, ElementCompute, RoundStyle, typename std::enable_if<((is_same_v<Activation<ElementCompute>, cutlass::epilogue::thread::ReLu<ElementCompute> > || is_same_v<Activation<ElementCompute>, cutlass::epilogue::thread::Clamp<ElementCompute> >) || is_same_v<Activation<ElementCompute>, cutlass::epilogue::thread::ThresholdReLU<ElementCompute> >), void>::type>, cutlass::epilogue::fusion::Sm90TreeVisitor<cutlass::epilogue::fusion::Sm90AuxStore<Stages, EpilogueTile, cutlass::integer_subbyte<1, false>, RoundStyle, StrideMNL, SmemLayoutAtom, CopyOpR2S, Alignment, EnableNullptr>, InputOp> >::ConsumerStoreCallbacks<RTensor, GTensor, CTensor, ThrResidue, CallbacksImpl>::end()’:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_compute_tma_warpspecialized.hpp:576:11: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  576 |           __syncwarp();
      |           ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_callbacks_tma_warpspecialized.hpp:49,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/sm90_epilogue_tma_warpspecialized.hpp:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:65,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_topk_softmax.hpp: In member function ‘void cutlass::epilogue::fusion::Sm90TopKSoftmaxColReduction<TopK, FragmentSize, CtaTileShapeMNK, EpilogueTile, ElementOutput, ElementCompute, RoundStyle, Alignment, UseButterflyReduce>::ReductionResult::shuffle_up_sync(uint32_t, int)’:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_topk_softmax.hpp:381:11: error: there are no arguments to ‘__shfl_up_sync’ that depend on a template parameter, so a declaration of ‘__shfl_up_sync’ must be available [-fpermissive]
  381 |       r = __shfl_up_sync(0xFFFFFFFF, r, delta);
      |           ^~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_topk_softmax.hpp: In member function ‘void cutlass::epilogue::fusion::Sm90TopKSoftmaxColReduction<TopK, FragmentSize, CtaTileShapeMNK, EpilogueTile, ElementOutput, ElementCompute, RoundStyle, Alignment, UseButterflyReduce>::TopKResult::shuffle_xor_sync(int)’:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_topk_softmax.hpp:408:17: error: there are no arguments to ‘__shfl_xor_sync’ that depend on a template parameter, so a declaration of ‘__shfl_xor_sync’ must be available [-fpermissive]
  408 |         top_k = __shfl_xor_sync(0xFFFFFFFF, top_k, laneMask);
      |                 ^~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_topk_softmax.hpp:418:24: error: there are no arguments to ‘__shfl_xor_sync’ that depend on a template parameter, so a declaration of ‘__shfl_xor_sync’ must be available [-fpermissive]
  418 |         top_k_arr[0] = __shfl_xor_sync(0xFFFFFFFF, top_k_arr[0], laneMask);
      |                        ^~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_topk_softmax.hpp:419:24: error: there are no arguments to ‘__shfl_xor_sync’ that depend on a template parameter, so a declaration of ‘__shfl_xor_sync’ must be available [-fpermissive]
  419 |         top_k_arr[1] = __shfl_xor_sync(0xFFFFFFFF, top_k_arr[1], laneMask);
      |                        ^~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_topk_softmax.hpp: In member function ‘void cutlass::epilogue::fusion::Sm90TopKSoftmaxColReduction<TopK, FragmentSize, CtaTileShapeMNK, EpilogueTile, ElementOutput, ElementCompute, RoundStyle, Alignment, UseButterflyReduce>::TopKResult::shuffle_down_sync(uint32_t)’:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_topk_softmax.hpp:439:17: error: there are no arguments to ‘__shfl_down_sync’ that depend on a template parameter, so a declaration of ‘__shfl_down_sync’ must be available [-fpermissive]
  439 |         top_k = __shfl_down_sync(0xFFFFFFFF, top_k, delta);
      |                 ^~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_topk_softmax.hpp:449:24: error: there are no arguments to ‘__shfl_down_sync’ that depend on a template parameter, so a declaration of ‘__shfl_down_sync’ must be available [-fpermissive]
  449 |         top_k_arr[0] = __shfl_down_sync(0xFFFFFFFF, top_k_arr[0], delta);
      |                        ^~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm90_visitor_topk_softmax.hpp:450:24: error: there are no arguments to ‘__shfl_down_sync’ that depend on a template parameter, so a declaration of ‘__shfl_down_sync’ must be available [-fpermissive]
  450 |         top_k_arr[1] = __shfl_down_sync(0xFFFFFFFF, top_k_arr[1], delta);
      |                        ^~~~~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm100_visitor_compute_tma_warpspecialized.hpp:46,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm100_callbacks_tma_warpspecialized.hpp:47,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm120_callbacks_tma_warpspecialized.hpp:46,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/sm90_epilogue_tma_warpspecialized.hpp:44,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:65,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm100_visitor_store_tma_warpspecialized.hpp: In member function ‘ElementCompute cutlass::epilogue::fusion::Sm100BlockScaleFactorColStore<SFVecSize, EpilogueTile, ElementOutput, ElementCompute, ElementBlockScaleFactor, RoundStyle>::ConsumerStoreCallbacks<RTensor, GTensor, STensor, CoordGTensor, ThrResidue, EpiTileCoordMN, ElementType>::find_amax(ElementCompute)’:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm100_visitor_store_tma_warpspecialized.hpp:497:38: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread’?
  497 |         const bool leading_thread = (threadIdx.x % NumThreadsPerWarp) == 0;
      |                                      ^~~~~~~~~
      |                                      thread
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm100_visitor_store_tma_warpspecialized.hpp: In member function ‘auto cutlass::epilogue::fusion::Sm100BlockScaleFactorColStore<SFVecSize, EpilogueTile, ElementOutput, ElementCompute, ElementBlockScaleFactor, RoundStyle>::ConsumerStoreCallbacks<RTensor, GTensor, STensor, CoordGTensor, ThrResidue, EpiTileCoordMN, ElementType>::visit(const cutlass::Array<ElementAccumulator, FragmentSize>&, int, int, int, const cutlass::Array<ElementInput, FragmentSize>&)’:
/home/less/local/cutlass40/include/cutlass/epilogue/fusion/sm100_visitor_store_tma_warpspecialized.hpp:573:35: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread’?
  573 |         int idx = i * SFVecSize + threadIdx.x % SFVecSize;
      |                                   ^~~~~~~~~
      |                                   thread
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:67,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm90_epilogue_array_tma_warpspecialized.hpp: In member function ‘auto cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm90PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore, NumEpilogueWarpGroups>, CtaTileMNK_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyAtomC_, CopyOpR2R_>::tensormaps_init(const cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm90PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore, NumEpilogueWarpGroups>, CtaTileMNK_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyAtomC_, CopyOpR2R_>::Params&, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm90PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore, NumEpilogueWarpGroups>, CtaTileMNK_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyAtomC_, CopyOpR2R_>::TensorMapStorage&, int32_t, int32_t, int32_t)’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm90_epilogue_array_tma_warpspecialized.hpp:1077:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1077 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm90_epilogue_array_tma_warpspecialized.hpp:1092:7: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1092 |       __syncwarp();
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:68,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_nosmem.hpp: In member function ‘auto cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100NoSmem, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, ThreadEpilogueOp_, CopyOpT2R_, AlignmentC_, AlignmentD_, typename std::enable_if<cutlass::epilogue::collective::IsDefaultFusionOp<ThreadEpilogueOp_>::value, void>::type>::operator()(AccumulatorPipeline, AccumulatorPipelineState, ProblemShapeMNKL, TileShapeMNK, TileCoordMNKL, const cute::Tensor<TC, CLayout>&, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100NoSmem, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, ThreadEpilogueOp_, CopyOpT2R_, AlignmentC_, AlignmentD_, typename std::enable_if<cutlass::epilogue::collective::IsDefaultFusionOp<ThreadEpilogueOp_>::value, void>::type>::SharedStorage&)’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_nosmem.hpp:235:23: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  235 |     auto thread_idx = threadIdx.x % size(tiled_t2r);
      |                       ^~~~~~~~~
      |                       thread_idx
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_nosmem.hpp: In member function ‘void cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100NoSmem, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, ThreadEpilogueOp_, CopyOpT2R_, AlignmentC_, AlignmentD_, typename std::enable_if<cutlass::epilogue::collective::IsDefaultFusionOp<ThreadEpilogueOp_>::value, void>::type>::operator()(ProblemShapeMNKL, TileShapeMNK, TileCoordMNKL, cute::Tensor<AccEngine, AccLayout>&, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100NoSmem, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, ThreadEpilogueOp_, CopyOpT2R_, AlignmentC_, AlignmentD_, typename std::enable_if<cutlass::epilogue::collective::IsDefaultFusionOp<ThreadEpilogueOp_>::value, void>::type>::SharedStorage&, TiledCopy)’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_nosmem.hpp:382:43: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread’?
  382 |     auto thread_t2r = tiled_t2r.get_slice(threadIdx.x % size(tiled_t2r));
      |                                           ^~~~~~~~~
      |                                           thread
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_nosmem.hpp: In member function ‘auto cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100NoSmem, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, AlignmentC_, AlignmentD_, typename std::enable_if<(! cutlass::epilogue::collective::IsDefaultFusionOp<ThreadEpilogueOp_>::value), void>::type>::operator()(AccumulatorPipeline, AccumulatorPipelineState, ProblemShapeMNKL, CtaTileMNK, CtaCoordMNKL, cute::Tensor<TC, CLayout>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100NoSmem, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, AlignmentC_, AlignmentD_, typename std::enable_if<(! cutlass::epilogue::collective::IsDefaultFusionOp<ThreadEpilogueOp_>::value), void>::type>::SharedStorage&)’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_nosmem.hpp:589:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  589 |     int thread_idx = threadIdx.x % ThreadCount;
      |                      ^~~~~~~~~
      |                      thread_idx
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:69,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_nosmem.hpp: In member function ‘auto cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayNoSmem, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, ThreadEpilogueOp_, CopyOpT2R_>::operator()(AccumulatorPipeline, AccumulatorPipelineState, ProblemShapeMNKL, TileShapeMNK, TileCoordMNKL, const cute::Tensor<TC, CLayout>&, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayNoSmem, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, ThreadEpilogueOp_, CopyOpT2R_>::SharedStorage&)’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_nosmem.hpp:242:43: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread’?
  242 |     auto thread_t2r = tiled_t2r.get_slice(threadIdx.x % size(tiled_t2r));
      |                                           ^~~~~~~~~
      |                                           thread
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_nosmem.hpp: In member function ‘void cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayNoSmem, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, ThreadEpilogueOp_, CopyOpT2R_>::operator()(ProblemShapeMNKL, TileShapeMNK, TileCoordMNKL, cute::Tensor<AccEngine, AccLayout>&, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayNoSmem, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, ThreadEpilogueOp_, CopyOpT2R_>::SharedStorage&, TiledCopy)’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_nosmem.hpp:366:43: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread’?
  366 |     auto thread_t2r = tiled_t2r.get_slice(threadIdx.x % size(tiled_t2r));
      |                                           ^~~~~~~~~
      |                                           thread
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:70,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_tma_warpspecialized.hpp: In member function ‘auto cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::store(cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::LoadPipeline, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::LoadPipelineState, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::StorePipeline, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::StorePipelineState, AccumulatorPipeline, AccumulatorPipelineState, ProblemShapeMNKL, CtaTileMNK, CtaCoordMNKL, MmaTileMNK, TiledMma, cute::Tensor<AccEngine, AccLayout>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::TensorStorage&)’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_tma_warpspecialized.hpp:603:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  603 |     int thread_idx = threadIdx.x % ThreadCount;
      |                      ^~~~~~~~~
      |                      thread_idx
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_tma_warpspecialized.hpp: In member function ‘auto cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::store(cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::LoadPipeline, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::LoadPipelineState, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::StorePipeline, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::StorePipelineState, ProblemShapeMNKL, CtaTileMNK, CtaCoordMNKL, MmaTileMNK, TiledMma, cute::Tensor<AccEngine, AccLayout>&, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100TmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::TensorStorage&, TiledCopyT2R)’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_tma_warpspecialized.hpp:1000:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
 1000 |     int thread_idx = threadIdx.x % ThreadCount;
      |                      ^~~~~~~~~
      |                      thread_idx
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_epilogue.hpp:71,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm90_builder.inl:41,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:121,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp: In member function ‘auto cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::store_init(const cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::Params&, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::TensorMapStorage&, int32_t, int32_t) const’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:593:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  593 |     int thread_idx = threadIdx.x % ThreadCount;
      |                      ^~~~~~~~~
      |                      thread_idx
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp: In member function ‘auto cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::store(cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::LoadPipeline, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::LoadPipelineState, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::StorePipeline, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::StorePipelineState, AccumulatorPipeline, AccumulatorPipelineState, ProblemShapeMNKL, CtaTileMNK, CtaCoordMNKL, MmaTileMNK, TiledMma, cute::Tensor<AccEngine, AccLayout>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::TensorStorage&, cute::tuple<TensorMapD, bool>)’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:646:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  646 |     int thread_idx = threadIdx.x % ThreadCount;
      |                      ^~~~~~~~~
      |                      thread_idx
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp: In member function ‘auto cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::store(cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::LoadPipeline, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::LoadPipelineState, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::StorePipeline, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::StorePipelineState, ProblemShapeMNKL, CtaTileMNK, CtaCoordMNKL, MmaTileMNK, TiledMma, cute::Tensor<AccEngine, AccLayout>&, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::TensorStorage&, TensorMapD, TiledCopyT2R)’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:1052:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
 1052 |     int thread_idx = threadIdx.x % ThreadCount;
      |                      ^~~~~~~~~
      |                      thread_idx
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp: In member function ‘auto cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::tensormaps_init(const cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::Params&, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::TensorMapStorage&, int32_t, int32_t) const’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:1363:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1363 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:1374:7: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1374 |       __syncwarp();
      |       ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp: In member function ‘void cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::tensormaps_perform_update(cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::TensorMapStorage&, const cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<StagesC, StagesD, FragmentSize, ReuseSmemC, DelayTmaStore>, CtaTileShape_, EpilogueTile_, ElementC_, StrideC_, ElementD_, StrideD_, FusionCallbacks_, CopyOpT2R_, CopyOpG2S_, SmemLayoutAtomC_, CopyOpS2R_, CopyOpS2G_, SmemLayoutAtomD_, CopyOpR2S_, CopyOpR2R_>::Params&, const TmaDescriptor*, ProblemShape, int32_t)’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:1475:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1475 |     __syncwarp();
      |     ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/builders/sm100_common.inl:35,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm100_builder.inl:44,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:122,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_tile_scheduler.hpp: In member function ‘cutlass::gemm::kernel::detail::PersistentTileSchedulerSm100<ClusterShape_, Stages_>::WorkTileInfo cutlass::gemm::kernel::detail::PersistentTileSchedulerSm100<ClusterShape_, Stages_>::initial_work_tile_info(ClusterShape)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_tile_scheduler.hpp:369:34: error: ‘blockIdx’ was not declared in this scope
  369 |     return swizzle_and_rasterize(blockIdx.x, blockIdx.y, blockIdx.z, /*valid=*/true, /*cluster_offset_m=*/0, /*cluster_offset_n=*/0);
      |                                  ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_tile_scheduler.hpp: In member function ‘cutlass::gemm::kernel::detail::PersistentTileSchedulerSm100<ClusterShape_, Stages_>::WorkTileInfo cutlass::gemm::kernel::detail::PersistentTileSchedulerSm100<ClusterShape_, Stages_>::swizzle_and_rasterize(int, int, int, bool, int, int) const’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_tile_scheduler.hpp:772:71: error: ‘gridDim’ was not declared in this scope
  772 |       int32_t major_clusters = params_.divmod_cluster_shape_m_.divide(gridDim.x);
      |                                                                       ^~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm70_mma_twostage.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm70TwoStageUnpredicated, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::operator()(FrgTensorD&, TensorA, TensorB, const FrgTensorC&, KTileIterator, int, ResidueMNK, int, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm70_mma_twostage.hpp:240:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  240 |     __syncthreads();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm70_mma_twostage.hpp: In lambda function:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm70_mma_twostage.hpp:260:11: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  260 |           __syncthreads();
      |           ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm70_mma_twostage.hpp:265:11: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  265 |           __syncthreads();
      |           ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm70_mma_twostage.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm70TwoStage, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::operator()(FrgTensorD&, TensorA, TensorB, const FrgTensorC&, KTileIterator, int, ResidueMNK, int, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm70_mma_twostage.hpp:537:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  537 |     __syncthreads();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm70_mma_twostage.hpp: In lambda function:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm70_mma_twostage.hpp:557:11: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  557 |           __syncthreads();
      |           ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm70_mma_twostage.hpp:562:11: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  562 |           __syncthreads();
      |           ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:39,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm80CpAsyncUnpredicated<Stages>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::operator()(FrgTensorD&, TensorA, TensorB, const FrgTensorC&, KTileIterator, int, ResidueMNK, int, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp:285:7: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  285 |       __syncthreads();
      |       ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp: In lambda function:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp:308:11: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  308 |           __syncthreads();
      |           ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm80CpAsyncUnpredicated<Stages>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::operator()(FrgTensorD&, TensorA, TensorB, const FrgTensorC&, KTileIterator, int, ResidueMNK, int, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp:342:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  342 |     __syncthreads();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm80CpAsync<Stages, ClusterShape_>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::operator()(FrgTensorD&, TensorA, TensorB, const FrgTensorC&, KTileIterator, int, ResidueMNK, int, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp:640:7: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  640 |       __syncthreads();
      |       ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp: In lambda function:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp:663:11: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  663 |           __syncthreads();
      |           ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm80CpAsync<Stages, ClusterShape_>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::operator()(FrgTensorD&, TensorA, TensorB, const FrgTensorC&, KTileIterator, int, ResidueMNK, int, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm80_mma_multistage.hpp:699:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  699 |     __syncthreads();
      |     ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:40,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_multistage_gmma_ss_warpspecialized.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90CpAsyncGmmaWarpSpecialized<Stages, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90CpAsyncGmmaWarpSpecialized<Stages, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90CpAsyncGmmaWarpSpecialized<Stages, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90CpAsyncGmmaWarpSpecialized<Stages, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_multistage_gmma_ss_warpspecialized.hpp:376:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  376 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_multistage_gmma_rs_warpspecialized.hpp:37,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:41,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/transform/collective/sm90_wgmma_transpose.hpp: In member function ‘void cutlass::transform::collective::detail::UniversalTranspositionOperandB<TiledMma_, SmemLayoutB_, SmemLayoutAtomB_, ElementB_>::operator()(const TensorSmemB&, const TensorTransposedSmemB&, int, int)’:
/home/less/local/cutlass40/include/cutlass/transform/collective/sm90_wgmma_transpose.hpp:227:9: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  227 |         __syncthreads();
      |         ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/collective/sm90_wgmma_transpose.hpp: In member function ‘void cutlass::transform::collective::detail::AsyncTranspositionOperandB<TiledMma_, SmemLayoutB_, SmemLayoutAtomB_, ElementB_>::operator()(const TensorSmemB&, const TensorTransposedSmemB&, int, int)’:
/home/less/local/cutlass40/include/cutlass/transform/collective/sm90_wgmma_transpose.hpp:435:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  435 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/collective/sm90_wgmma_transpose.hpp: In member function ‘void cutlass::transform::collective::detail::AsyncTranspositionOperandB_1BElementB<TiledMma_, SmemLayoutB_, SmemLayoutAtomB_, ElementB_>::operator()(const TensorSmemB&, const TensorTransposedSmemB&, int, int)’:
/home/less/local/cutlass40/include/cutlass/transform/collective/sm90_wgmma_transpose.hpp:660:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  660 |         __syncwarp();
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:41,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_multistage_gmma_rs_warpspecialized.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90CpAsyncGmmaRmemAWarpSpecialized<Stages, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90CpAsyncGmmaRmemAWarpSpecialized<Stages, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90CpAsyncGmmaRmemAWarpSpecialized<Stages, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90CpAsyncGmmaRmemAWarpSpecialized<Stages, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90CpAsyncGmmaRmemAWarpSpecialized<Stages, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_multistage_gmma_rs_warpspecialized.hpp:458:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  458 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:42,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_ss.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmma<Stages, ClusterShape, PipelineAsyncMmaStages>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::operator()(const TensorA&, TMA_LOAD_A&, const TensorB&, TMA_LOAD_B&, FrgTensorC&, KTileIterator, int, int, uint32_t, char*, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmma<Stages, ClusterShape, PipelineAsyncMmaStages>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_ss.hpp:354:7: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  354 |       __syncthreads();
      |       ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_ss.hpp:414:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  414 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_ss.hpp:435:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  435 |     __syncthreads();
      |     ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:43,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_rs_warpspecialized.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaRmemAWarpSpecialized<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaRmemAWarpSpecialized<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaRmemAWarpSpecialized<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaRmemAWarpSpecialized<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaRmemAWarpSpecialized<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_rs_warpspecialized.hpp:547:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  547 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_rs_warpspecialized_mixed_input.hpp:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/detail/collective/mixed_input_utils.hpp: In static member function ‘static void cutlass::LayoutAwareConvertImpl<cutlass::integer_subbyte<4, true>, cutlass::half_t, cute::Layout<cute::tuple<cute::C<2>, cute::C<4> >, cute::tuple<cute::C<4>, cute::C<1> > >, cute::Layout<cute::C<8>, cute::C<1> > >::convert(const cute::Tensor<EngineIn, cute::Layout<cute::tuple<cute::C<2>, cute::C<4> >, cute::tuple<cute::C<4>, cute::C<1> > > >&, cute::Tensor<EngineOut, cute::Layout<cute::C<8>, cute::C<1> > >&)’:
/home/less/local/cutlass40/include/cutlass/detail/collective/mixed_input_utils.hpp:232:22: error: there are no arguments to ‘__hfma2’ that depend on a template parameter, so a declaration of ‘__hfma2’ must be available [-fpermissive]
  232 |         fp16x2_val = __hfma2(fp16x2_val,
      |                      ^~~~~~~
/home/less/local/cutlass40/include/cutlass/detail/collective/mixed_input_utils.hpp: In static member function ‘static void cutlass::LayoutAwareConvertImpl<cutlass::integer_subbyte<4, false>, cutlass::half_t, cute::Layout<cute::tuple<cute::C<2>, cute::C<4> >, cute::tuple<cute::C<4>, cute::C<1> > >, cute::Layout<cute::C<8>, cute::C<1> > >::convert(const cute::Tensor<EngineIn, cute::Layout<cute::tuple<cute::C<2>, cute::C<4> >, cute::tuple<cute::C<4>, cute::C<1> > > >&, cute::Tensor<EngineOut, cute::Layout<cute::C<8>, cute::C<1> > >&)’:
/home/less/local/cutlass40/include/cutlass/detail/collective/mixed_input_utils.hpp:297:22: error: there are no arguments to ‘__hfma2’ that depend on a template parameter, so a declaration of ‘__hfma2’ must be available [-fpermissive]
  297 |         fp16x2_val = __hfma2(fp16x2_val,
      |                      ^~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_rs_warpspecialized_mixed_input.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaRmemAWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaRmemAWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaRmemAWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaRmemAWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaRmemAWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_rs_warpspecialized_mixed_input.hpp:802:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  802 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_ss_warpspecialized.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_ss_warpspecialized.hpp:452:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  452 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_sparse_mma_tma_gmma_ss_warpspecialized.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedSparse<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedSparse<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedSparse<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedSparse<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedSparse<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_sparse_mma_tma_gmma_ss_warpspecialized.hpp:536:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  536 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_sparse_mma_tma_gmma_ss_warpspecialized_fp8.hpp:35,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp: In member function ‘void cutlass::gemm::collective::GmmaFP8Accumulation<EngineAccum, LayoutAccum>::promote_if_needed()’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp:166:25: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  166 |     reset_accum_flag_ = __shfl_sync(0xffffffff, mma_count_ == accum_promotion_interval_, 0);
      |                         ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp: In member function ‘void cutlass::gemm::collective::GmmaFP8Accumulation<EngineAccum, LayoutAccum>::promote_residue_if_needed()’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp:176:9: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  176 |     if (__shfl_sync(0xffffffff, mma_count_ > 0, 0)) {
      |         ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp: In member function ‘void cutlass::gemm::collective::GmmaFP8Accumulation<EngineAccum, LayoutAccum>::scale_if_needed(const ElementAccumulator&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp:189:25: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  189 |     reset_accum_flag_ = __shfl_sync(0xffffffff, mma_count_ == accum_promotion_interval_, 0);
      |                         ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp: In member function ‘void cutlass::gemm::collective::GmmaFP8Accumulation<EngineAccum, LayoutAccum>::scale_if_needed(const cute::Tensor<TD, DLayout>&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp:202:25: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  202 |     reset_accum_flag_ = __shfl_sync(0xffffffff, mma_count_ == accum_promotion_interval_, 0);
      |                         ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp: In member function ‘void cutlass::gemm::collective::GmmaFP8Accumulation<EngineAccum, LayoutAccum>::scale_if_needed(const cute::Tensor<TD, DLayout>&, const cute::Tensor<TA, ALayout>&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp:217:25: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  217 |     reset_accum_flag_ = __shfl_sync(0xffffffff, mma_count_ == accum_promotion_interval_, 0);
      |                         ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp: In member function ‘void cutlass::gemm::collective::GmmaFP8Accumulation<EngineAccum, LayoutAccum>::scale_residue_if_needed(const ElementAccumulator&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp:251:9: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  251 |     if (__shfl_sync(0xffffffff, mma_count_ > 0, 0)) {
      |         ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp: In member function ‘void cutlass::gemm::collective::GmmaFP8Accumulation<EngineAccum, LayoutAccum>::scale_residue_if_needed(const cute::Tensor<TD, DLayout>&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp:261:9: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  261 |     if (__shfl_sync(0xffffffff, mma_count_ > 0, 0)) {
      |         ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp: In member function ‘void cutlass::gemm::collective::GmmaFP8Accumulation<EngineAccum, LayoutAccum>::scale_residue_if_needed(const cute::Tensor<TD, DLayout>&, const cute::Tensor<TA, ALayout>&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/fp8_accumulation.hpp:273:9: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  273 |     if (__shfl_sync(0xffffffff, mma_count_ > 0, 0)) {
      |         ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_sparse_mma_tma_gmma_ss_warpspecialized_fp8.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedSparseFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedSparseFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedSparseFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedSparseFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedSparseFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_sparse_mma_tma_gmma_ss_warpspecialized_fp8.hpp:547:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  547 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized.hpp:502:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  502 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::tensormaps_init(const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecialized<Stages_, ClusterShape_, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, int32_t, int32_t)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized.hpp:649:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  649 |     __syncwarp();
      |     ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_rs_warpspecialized_mixed_input.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_rs_warpspecialized_mixed_input.hpp:899:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  899 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_rs_warpspecialized_mixed_input.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::tensormaps_init(const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedMixedInput<Stages, ClusterShape, KernelSchedule_>, TileShape_, ElementAOptionalTuple, StrideA_, ElementBOptionalTuple, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, int32_t, int32_t)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_rs_warpspecialized_mixed_input.hpp:1175:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1175 |     __syncwarp();
      |     ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_ss_warpspecialized_fp8.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_ss_warpspecialized_fp8.hpp:453:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  453 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized_fp8.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized_fp8.hpp:503:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  503 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized_fp8.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::tensormaps_init(const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, int32_t, int32_t)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized_fp8.hpp:658:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  658 |     __syncwarp();
      |     ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_ss_warpspecialized_fp8_blockwise_scaling.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedBlockScalingFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedBlockScalingFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedBlockScalingFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedBlockScalingFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90TmaGmmaWarpSpecializedBlockScalingFP8<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_tma_gmma_ss_warpspecialized_fp8_blockwise_scaling.hpp:815:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  815 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized_fp8_blockwise_scaling.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedBlockScaling<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::mma(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedBlockScaling<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedBlockScaling<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::PipelineState, FrgTensorC&, int, int, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedBlockScaling<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedBlockScaling<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized_fp8_blockwise_scaling.hpp:780:26: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
  780 |     int warp_group_idx = __shfl_sync(0xFFFFFFFF, thread_idx / NumThreadsPerWarpGroup, 0);
      |                          ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized_fp8_blockwise_scaling.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedBlockScaling<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::tensormaps_init(const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedBlockScaling<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm90ArrayTmaGmmaWarpSpecializedBlockScaling<Stages, ClusterShape, KernelSchedule>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, int32_t, int32_t)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm90_mma_array_tma_gmma_ss_warpspecialized_fp8_blockwise_scaling.hpp:1098:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1098 |     __syncwarp();
      |     ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::load_init(const ProblemShape_MNKL&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized.hpp:514:43: error: ‘blockIdx’ was not declared in this scope
  514 |     ThrMMA cta_mma = TiledMma{}.get_slice(blockIdx.x % size(typename TiledMma::AtomThrID{}));
      |                                           ^~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::load_init(const ProblemShape_MNKL&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, int32_t, int32_t, int32_t) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized.hpp:500:43: error: ‘blockIdx’ was not declared in this scope
  500 |     ThrMMA cta_mma = TiledMma{}.get_slice(blockIdx.x % size(typename TiledMma::AtomThrID{}));
      |                                           ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::tensormaps_init(const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, int32_t, int32_t) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized.hpp:735:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  735 |     __syncwarp();
      |     ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::tensormaps_perform_update(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StrideA_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&, const cute::tuple<TensorA, TensorB>&, ProblemShape, int32_t)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized.hpp:822:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  822 |     __syncwarp();
      |     ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_emulated.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedFastF32<Load2TransformPipelineStageCount_, Transform2MmaPipelineStageCount_, SchedulerPipelineStageCount_, AccumulatorPipelineStageCount_, NumBandsToCompute_, ScalingFactor_, AccPromotionInterval_, ClusterShape, AccumulatorCopyAtom_>, TileShape_, float, StrideA_, float, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomsA_, CopyAtomsA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomsB_, CopyAtomsB_, TransformB_>::load_init(const ProblemShape_MNKL&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedFastF32<Load2TransformPipelineStageCount_, Transform2MmaPipelineStageCount_, SchedulerPipelineStageCount_, AccumulatorPipelineStageCount_, NumBandsToCompute_, ScalingFactor_, AccPromotionInterval_, ClusterShape, AccumulatorCopyAtom_>, TileShape_, float, StrideA_, float, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomsA_, CopyAtomsA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomsB_, CopyAtomsB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedFastF32<Load2TransformPipelineStageCount_, Transform2MmaPipelineStageCount_, SchedulerPipelineStageCount_, AccumulatorPipelineStageCount_, NumBandsToCompute_, ScalingFactor_, AccPromotionInterval_, ClusterShape, AccumulatorCopyAtom_>, TileShape_, float, StrideA_, float, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomsA_, CopyAtomsA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomsB_, CopyAtomsB_, TransformB_>::TensorStorage&) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_emulated.hpp:535:43: error: ‘blockIdx’ was not declared in this scope
  535 |     ThrMMA cta_mma = TiledMma{}.get_slice(blockIdx.x % size(typename TiledMma::AtomThrID{}));
      |                                           ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_emulated.hpp: In lambda function:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_emulated.hpp:738:70: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  738 |         auto thr_reg2tmem_tiled_copy = reg2tmem_tiled_copy.get_slice(threadIdx.x % NumTransformationThreads);
      |                                                                      ^~~~~~~~~
      |                                                                      thread0
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_emulated.hpp:748:70: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  748 |         auto thr_reg2smem_tiled_copy = reg2smem_tiled_copy.get_slice(threadIdx.x % NumTransformationThreads);
      |                                                                      ^~~~~~~~~
      |                                                                      thread0
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_emulated.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedFastF32<Load2TransformPipelineStageCount_, Transform2MmaPipelineStageCount_, SchedulerPipelineStageCount_, AccumulatorPipelineStageCount_, NumBandsToCompute_, ScalingFactor_, AccPromotionInterval_, ClusterShape, AccumulatorCopyAtom_>, TileShape_, float, StrideA_, float, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomsA_, CopyAtomsA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomsB_, CopyAtomsB_, TransformB_>::accum_init(const cute::Tensor<TD, DLayout>&, TmemCopyAtom, EpilogueTile)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_emulated.hpp:926:43: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  926 |     auto thread_t2r = tiled_t2r.get_slice(threadIdx.x % size(tiled_t2r));
      |                                           ^~~~~~~~~
      |                                           thread0
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_emulated.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedFastF32<Load2TransformPipelineStageCount_, Transform2MmaPipelineStageCount_, SchedulerPipelineStageCount_, AccumulatorPipelineStageCount_, NumBandsToCompute_, ScalingFactor_, AccPromotionInterval_, ClusterShape, AccumulatorCopyAtom_>, TileShape_, float, StrideA_, float, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomsA_, CopyAtomsA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomsB_, CopyAtomsB_, TransformB_>::load_init(const ProblemShape_MNKL&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedFastF32<Load2TransformPipelineStageCount_, Transform2MmaPipelineStageCount_, SchedulerPipelineStageCount_, AccumulatorPipelineStageCount_, NumBandsToCompute_, ScalingFactor_, AccPromotionInterval_, ClusterShape, AccumulatorCopyAtom_>, TileShape_, float, StrideA_, float, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomsA_, CopyAtomsA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomsB_, CopyAtomsB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedFastF32<Load2TransformPipelineStageCount_, Transform2MmaPipelineStageCount_, SchedulerPipelineStageCount_, AccumulatorPipelineStageCount_, NumBandsToCompute_, ScalingFactor_, AccPromotionInterval_, ClusterShape, AccumulatorCopyAtom_>, TileShape_, float, StrideA_, float, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomsA_, CopyAtomsA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomsB_, CopyAtomsB_, TransformB_>::TensorStorage&, int32_t, int32_t) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_emulated.hpp:538:43: error: ‘blockIdx’ was not declared in this scope
  538 |     ThrMMA cta_mma = TiledMma{}.get_slice(blockIdx.x % size(typename TiledMma::AtomThrID{}));
      |                                           ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_emulated.hpp: In lambda function:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_emulated.hpp:745:70: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  745 |         auto thr_reg2tmem_tiled_copy = reg2tmem_tiled_copy.get_slice(threadIdx.x % NumTransformationThreads);
      |                                                                      ^~~~~~~~~
      |                                                                      thread0
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_emulated.hpp:755:70: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  755 |         auto thr_reg2smem_tiled_copy = reg2smem_tiled_copy.get_slice(threadIdx.x % NumTransformationThreads);
      |                                                                      ^~~~~~~~~
      |                                                                      thread0
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_emulated.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedFastF32<Load2TransformPipelineStageCount_, Transform2MmaPipelineStageCount_, SchedulerPipelineStageCount_, AccumulatorPipelineStageCount_, NumBandsToCompute_, ScalingFactor_, AccPromotionInterval_, ClusterShape, AccumulatorCopyAtom_>, TileShape_, float, StrideA_, float, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomsA_, CopyAtomsA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomsB_, CopyAtomsB_, TransformB_>::accum_init(const cute::Tensor<TD, DLayout>&, TmemCopyAtom, EpilogueTile)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_emulated.hpp:934:43: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  934 |     auto thread_t2r = tiled_t2r.get_slice(threadIdx.x % size(tiled_t2r));
      |                                           ^~~~~~~~~
      |                                           thread0
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_sparse_mma_warpspecialized.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedSparse<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::load_init(const ProblemShape_MNKL&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedSparse<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, LayoutPairAE_, ElementB_, StrideB_, TiledMma_, GmemTiledCopyA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_sparse_mma_warpspecialized.hpp:663:43: error: ‘blockIdx’ was not declared in this scope
  663 |     ThrMMA cta_mma = TiledMma{}.get_slice(blockIdx.x % size(typename TiledMma::AtomThrID{}));
      |                                           ^~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:60,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_blockscaled_sparse_mma_warpspecialized.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockScaledSparse<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, LayoutPairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::load_init(const ProblemShape_MNKL&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockScaledSparse<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, LayoutPairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::TensorStorage&) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_blockscaled_sparse_mma_warpspecialized.hpp:929:43: error: ‘blockIdx’ was not declared in this scope
  929 |     ThrMMA cta_mma = TiledMma{}.get_slice(blockIdx.x % size(typename TiledMma::AtomThrID{}));
      |                                           ^~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:61,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_blockscaled_mma_warpspecialized.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::load_init(const ProblemShape_MNKL&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::TensorStorage&) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_blockscaled_mma_warpspecialized.hpp:744:43: error: ‘blockIdx’ was not declared in this scope
  744 |     ThrMMA cta_mma = TiledMma{}.get_slice(blockIdx.x % size(typename TiledMma::AtomThrID{}));
      |                                           ^~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_blockscaled_mma_array_warpspecialized.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::load_init(const ProblemShape_MNKL&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, int32_t, int32_t, int32_t) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_blockscaled_mma_array_warpspecialized.hpp:712:43: error: ‘blockIdx’ was not declared in this scope
  712 |     ThrMMA cta_mma = TiledMma{}.get_slice(blockIdx.x % size(typename TiledMma::AtomThrID{}));
      |                                           ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_blockscaled_mma_array_warpspecialized.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::tensormaps_init(const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, int32_t, int32_t) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_blockscaled_mma_array_warpspecialized.hpp:1118:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1118 |     __syncwarp();
      |     ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_blockscaled_mma_array_warpspecialized.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::tensormaps_perform_update(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomPairA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomPairB_, SmemCopyAtomB_, TransformB_>::Params&, const cute::tuple<TensorA, TensorB, TensorScaleA, TensorScaleB>&, ProblemShape, int32_t)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_blockscaled_mma_array_warpspecialized.hpp:1235:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1235 |     __syncwarp();
      |     ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_blockwise_scaling.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::load_ab_init(const ProblemShape_MNKL&, const MainloopParams&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_blockwise_scaling.hpp:658:43: error: ‘blockIdx’ was not declared in this scope
  658 |     ThrMMA cta_mma = TiledMma{}.get_slice(blockIdx.x % size(typename TiledMma::AtomThrID{}));
      |                                           ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_blockwise_scaling.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::load_sf_init(const ProblemShape_MNKL&, const MainloopParams&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_blockwise_scaling.hpp:740:55: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  740 |     ThrCopy thr_scale_copy_a = scale_copy_a.get_slice(threadIdx.x % size(scale_copy_a));
      |                                                       ^~~~~~~~~
      |                                                       thread0
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_blockwise_scaling.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::load_sf(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopSFPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopSFPipelineState, const LoadSFParams&, const TileCoordMNKL&, KTileIterator, int)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_blockwise_scaling.hpp:954:91: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  954 |         thr_tile_pSFA(i) = elem_less(thr_tile_SFA(i), shape(filter_zeros(layout_SFA))) && threadIdx.x % 32 < size(scale_copy_a);
      |                                                                                           ^~~~~~~~~
      |                                                                                           thread0
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_blockwise_scaling.hpp:960:91: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  960 |         thr_tile_pSFB(i) = elem_less(thr_tile_SFB(i), shape(filter_zeros(layout_SFB))) && threadIdx.x % 32 < size(scale_copy_b);
      |                                                                                           ^~~~~~~~~
      |                                                                                           thread0
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_blockwise_scaling.hpp:967:7: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  967 |       __syncwarp();
      |       ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_blockwise_scaling.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::accum(cute::tuple<cutlass::PipelineUmmaAsync<AccumulatorPipelineStageCount, cute::tuple<decltype (shape<0>(typename TiledMma_::ThrLayoutVMNK{})), cute::C<1>, cute::C<1> > >, cutlass::PipelineAsync<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>::Stages> >, cute::tuple<typename cutlass::PipelineUmmaAsync<AccumulatorPipelineStageCount, cute::tuple<decltype (shape<0>(typename TiledMma_::ThrLayoutVMNK{})), cute::C<1>, cute::C<1> > >::PipelineState, typename cutlass::PipelineAsync<cutlass::gemm::MainloopSm100TmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>::Stages>::PipelineState>, TmemStorage, const AccumTransformParams&, CtaTileCoord, CopyOpT2R, EpilogueTile, int)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_warpspecialized_blockwise_scaling.hpp:1131:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
 1131 |     int thread_idx = threadIdx.x % size(tiled_t2r_epi);
      |                      ^~~~~~~~~
      |                      thread_idx
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:64,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::load_ab_init(const ProblemShape_MNKL&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, int32_t, int32_t, int32_t) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp:597:43: error: ‘blockIdx’ was not declared in this scope
  597 |     ThrMMA cta_mma = TiledMma{}.get_slice(blockIdx.x % size(typename TiledMma::AtomThrID{}));
      |                                           ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::load_sf_update(const ProblemShape_MNKL&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorStorage&, int) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp:710:55: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  710 |     ThrCopy thr_scale_copy_a = scale_copy_a.get_slice(threadIdx.x % size(scale_copy_a));
      |                                                       ^~~~~~~~~
      |                                                       thread0
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::load_sf(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopSFPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::MainloopSFPipelineState, const cute::tuple<UnusedGTensorA, GTensorPartitionedSFA, GTensorPartitionedSFB, STensorSFA, STensorSFB, IdentPartitionedSFA, IdentPartitionedSFB, typename std::remove_pointer<typename cute::remove_cvref<decltype (get<1>(LayoutPairAE_{}))>::type>::type, typename std::remove_pointer<typename cute::remove_cvref<decltype (get<1>(StridePairB_{}))>::type>::type>&, const TileCoordMNKL&, KTileIterator, int)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp:925:91: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  925 |         thr_tile_pSFA(i) = elem_less(thr_tile_SFA(i), shape(filter_zeros(layout_SFA))) && threadIdx.x % 32 < size(scale_copy_a);
      |                                                                                           ^~~~~~~~~
      |                                                                                           thread0
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp:931:91: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  931 |         thr_tile_pSFB(i) = elem_less(thr_tile_SFB(i), shape(filter_zeros(layout_SFB))) && threadIdx.x % 32 < size(scale_copy_b);
      |                                                                                           ^~~~~~~~~
      |                                                                                           thread0
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp:938:7: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  938 |       __syncwarp();
      |       ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::accum(cute::tuple<cutlass::PipelineUmmaAsync<AccumulatorPipelineStageCount, cute::tuple<decltype (shape<0>(typename TiledMma_::ThrLayoutVMNK{})), cute::C<1>, cute::C<1> > >, cutlass::PipelineAsync<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>::Stages> >, cute::tuple<typename cutlass::PipelineUmmaAsync<AccumulatorPipelineStageCount, cute::tuple<decltype (shape<0>(typename TiledMma_::ThrLayoutVMNK{})), cute::C<1>, cute::C<1> > >::PipelineState, typename cutlass::PipelineAsync<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>::Stages>::PipelineState>, const cute::Tensor<TD, DLayout>&, const cute::tuple<TensorMapA, TensorMapB>&, CtaTileCoord, CopyOpT2R, EpilogueTile, int)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp:1101:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
 1101 |     int thread_idx = threadIdx.x % size(tiled_t2r_epi);
      |                      ^~~~~~~~~
      |                      thread_idx
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::tensormaps_init(const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, int32_t, int32_t) const’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp:1214:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1214 |     __syncwarp();
      |     ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::tensormaps_perform_update(cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::TensorMapStorage&, const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecializedBlockwiseScaling<Stages, SchedulerPipelineStageCount, AccumulatorPipelineStageCount, ClusterShape>, TileShape_, ElementA_, StridePairA_, ElementB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomA_, SmemCopyAtomA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomB_, SmemCopyAtomB_, TransformB_>::Params&, const cute::tuple<TensorA, TensorB>&, ProblemShape, int32_t)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized_blockwise_scaling.hpp:1301:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1301 |     __syncwarp();
      |     ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:66,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm120_blockscaled_mma_tma.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120TmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::load(const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120TmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120TmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120TmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::PipelineState, const cute::tuple<TensorA, TensorB, TensorScaleA, TensorScaleB>&, const BlockCoord&, KTileIterator, int, int, uint32_t, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120TmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::TensorStorage&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm120_blockscaled_mma_tma.hpp:674:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  674 |     __syncwarp();
      |     ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_mma.hpp:67,
                 from /home/less/local/cutlass40/include/cutlass/gemm/collective/collective_builder.hpp:35,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:13:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm120_blockscaled_mma_array_tma.hpp: In member function ‘void cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120ArrayTmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::load(const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120ArrayTmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120ArrayTmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::MainloopPipeline, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120ArrayTmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::PipelineState, const cute::tuple<TensorA, TensorB, TensorScaleA, TensorScaleB>&, const cute::tuple<TensorMapA, TensorMapB, TensorMapSFA, TensorMapSFB>&, const BlockCoord&, KTileIterator, int, int, uint32_t, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120ArrayTmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::TensorStorage&)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm120_blockscaled_mma_array_tma.hpp:759:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  759 |     __syncwarp();
      |     ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm120_blockscaled_mma_array_tma.hpp: In member function ‘auto cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120ArrayTmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::tensormaps_init(const cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120ArrayTmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::Params&, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm120ArrayTmaWarpSpecializedBlockScaled<Stages, SchedulerPipelineStageCount, ClusterShape, KernelScheduleType>, TileShape_, ElementPairA_, StridePairA_, ElementPairB_, StridePairB_, TiledMma_, GmemTiledCopyPairA_, SmemLayoutAtomsA_, SmemCopyAtomsA_, TransformA_, GmemTiledCopyPairB_, SmemLayoutAtomsB_, SmemCopyAtomsB_, TransformB_>::TensorMapStorage&, int32_t, int32_t)’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm120_blockscaled_mma_array_tma.hpp:1003:5: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
 1003 |     __syncwarp();
      |     ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:47,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/kernel_launch.h: In function ‘cutlass::Status cutlass::kernel_launch(dim3, dim3, size_t, cudaStream_t, const Params&, bool)’:
/home/less/local/cutlass40/include/cutlass/kernel_launch.h:91:32: error: expected primary-expression before ‘<’ token
   91 |     device_kernel<GemmKernel><<<grid_dims, block_dims, smem_size, cuda_stream>>>(kernel_params);
      |                                ^
/home/less/local/cutlass40/include/cutlass/kernel_launch.h:91:80: error: expected primary-expression before ‘>’ token
   91 |     device_kernel<GemmKernel><<<grid_dims, block_dims, smem_size, cuda_stream>>>(kernel_params);
      |                                                                                ^
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/semaphore.h: In member function ‘void cutlass::Semaphore::wait(int)’:
/home/less/local/cutlass40/include/cutlass/semaphore.h:92:12: error: ‘__syncthreads_and’ was not declared in this scope
   92 |     while( __syncthreads_and(state != status) ) {
      |            ^~~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/semaphore.h:96:5: error: ‘__syncthreads’ was not declared in this scope
   96 |     __syncthreads();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/semaphore.h: In member function ‘void cutlass::Semaphore::release(int)’:
/home/less/local/cutlass40/include/cutlass/semaphore.h:102:5: error: ‘__syncthreads’ was not declared in this scope
  102 |     __syncthreads();
      |     ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp:34,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/tile_scheduler.hpp:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:34,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/barrier.h: In static member function ‘static void cutlass::detail::SyncthreadsSync::sync()’:
/home/less/local/cutlass40/include/cutlass/barrier.h:53:5: error: ‘__syncthreads’ was not declared in this scope
   53 |     __syncthreads();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/barrier.h: In static member function ‘static void cutlass::detail::SyncwarpSync::sync()’:
/home/less/local/cutlass40/include/cutlass/barrier.h:60:5: error: ‘__syncwarp’ was not declared in this scope
   60 |     __syncwarp();
      |     ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/barrier.h: In static member function ‘static void cutlass::GenericBarrier<Sync>::red_release(int*, int)’:
/home/less/local/cutlass40/include/cutlass/barrier.h:127:5: error: there are no arguments to ‘__threadfence’ that depend on a template parameter, so a declaration of ‘__threadfence’ must be available [-fpermissive]
  127 |     __threadfence();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/barrier.h:128:5: error: there are no arguments to ‘atomicAdd’ that depend on a template parameter, so a declaration of ‘atomicAdd’ must be available [-fpermissive]
  128 |     atomicAdd(ptr, val);
      |     ^~~~~~~~~
/home/less/local/cutlass40/include/cutlass/barrier.h: In static member function ‘static void cutlass::GenericBarrier<Sync>::wait_eq_reset(void*, int, int, cutlass::GenericBarrier<Sync>::T)’:
/home/less/local/cutlass40/include/cutlass/barrier.h:175:15: error: there are no arguments to ‘atomicCAS’ that depend on a template parameter, so a declaration of ‘atomicCAS’ must be available [-fpermissive]
  175 |         while(atomicCAS(flag_ptr, val, 0) != val) {}
      |               ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/tile_scheduler.hpp:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:34,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp: In constructor ‘cutlass::gemm::kernel::detail::PersistentTileSchedulerSm90StreamK<TileShape, ClusterShape>::PersistentTileSchedulerSm90StreamK(const Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp:261:43: error: ‘blockIdx’ was not declared in this scope
  261 |       current_work_linear_idx_ = uint64_t(blockIdx.x) + uint64_t(blockIdx.y) * uint64_t(gridDim.x);
      |                                           ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp:261:89: error: ‘gridDim’ was not declared in this scope
  261 |       current_work_linear_idx_ = uint64_t(blockIdx.x) + uint64_t(blockIdx.y) * uint64_t(gridDim.x);
      |                                                                                         ^~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp:264:43: error: ‘blockIdx’ was not declared in this scope
  264 |       current_work_linear_idx_ = uint64_t(blockIdx.x) * uint64_t(gridDim.y) + uint64_t(blockIdx.y);
      |                                           ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp:264:66: error: ‘gridDim’ was not declared in this scope
  264 |       current_work_linear_idx_ = uint64_t(blockIdx.x) * uint64_t(gridDim.y) + uint64_t(blockIdx.y);
      |                                                                  ^~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp: In member function ‘void cutlass::gemm::kernel::detail::PersistentTileSchedulerSm90StreamK<TileShape, ClusterShape>::advance_to_next_work(uint32_t)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp:326:42: error: ‘gridDim’ was not declared in this scope
  326 |     current_work_linear_idx_ += uint64_t(gridDim.x) * uint64_t(gridDim.y) * uint64_t(gridDim.z) * uint64_t(advance_count);
      |                                          ^~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp: In member function ‘bool cutlass::gemm::kernel::detail::PersistentTileSchedulerSm90StreamK<TileShape, ClusterShape>::is_last_tile(cutlass::gemm::kernel::detail::PersistentTileSchedulerSm90StreamK<TileShape, ClusterShape>::WorkTileInfo, uint32_t) const’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp:339:20: error: ‘gridDim’ was not declared in this scope
  339 |           uint64_t(gridDim.x) * uint64_t(gridDim.y) * uint64_t(gridDim.z) * uint64_t(advance_count)
      |                    ^~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp: In static member function ‘static void cutlass::gemm::kernel::detail::PersistentTileSchedulerSm90StreamK<TileShape, ClusterShape>::fixup_helper(const Params&, const cutlass::gemm::kernel::detail::PersistentTileSchedulerSm90StreamK<TileShape, ClusterShape>::WorkTileInfo&, FrgTensorC&, uint32_t, uint32_t, uint32_t, uint32_t)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_stream_k.hpp:472:41: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  472 |     uint32_t barrier_group_thread_idx = threadIdx.x % BarrierManager::ThreadCount;
      |                                         ^~~~~~~~~
      |                                         thread0
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/tile_scheduler.hpp:66,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:34,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_group.hpp: In static member function ‘static WorkTileInfo cutlass::gemm::kernel::detail::PersistentTileSchedulerSm90Group<GroupProblemShape, SchedulerPipelineStageCount>::get_work_idx_m_and_n(uint64_t, GroupInfo&, int32_t, ProblemShape*, ProblemShape (&)[2], cutlass::gemm::GemmCoord, cutlass::gemm::GemmCoord, const cutlass::FastDivmodU64Pow2&, const cutlass::FastDivmodU64Pow2&, const cutlass::FastDivmodU64&, const cutlass::FastDivmodU64&, int32_t, RasterOrder)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_group.hpp:351:41: error: there are no arguments to ‘__ffs’ that depend on a template parameter, so a declaration of ‘__ffs’ must be available [-fpermissive]
  351 |           int first_succeeding_thread = __ffs(thread_succeed) - 1;
      |                                         ^~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_group.hpp:380:30: error: ‘blockIdx’ was not declared in this scope
  380 |       cluster_minor_offset = blockIdx.x;
      |                              ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm90_tile_scheduler_group.hpp:383:30: error: ‘blockIdx’ was not declared in this scope
  383 |       cluster_minor_offset = blockIdx.y;
      |                              ^~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/tile_scheduler.hpp:68,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:34,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_tile_scheduler_stream_k.hpp: In member function ‘uint64_t cutlass::gemm::kernel::detail::PersistentTileSchedulerSm100StreamK<TileShape, ClusterShape, Stages_>::to_linear_idx(const InternalWorkTileInfo&, const Params&)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_tile_scheduler_stream_k.hpp:724:28: error: ‘gridDim’ was not declared in this scope
  724 |     uint64_t cluster_idx = gridDim.y * start_cta_m_preferred_cluster + start_cta_n_preferred_cluster;
      |                            ^~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_tile_scheduler_stream_k.hpp: In member function ‘AccumulatorPipelineState cutlass::gemm::kernel::detail::PersistentTileSchedulerSm100StreamK<TileShape, ClusterShape, Stages_>::tmem_fixup(const TiledMma&, const WorkTileInfo&, cute::Tensor<FrgEngine, FrgLayout>&, AccumulatorPipeline, AccumulatorPipelineState, CopyOpT2R, uint32_t, uint32_t) const’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_tile_scheduler_stream_k.hpp:916:46: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
  916 |     auto thr_tmem_load = tmem_load.get_slice(threadIdx.x % ThreadsForFixup);
      |                                              ^~~~~~~~~
      |                                              thread0
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm70_gemm.hpp: In member function ‘void cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileScheduler_, typename std::enable_if<is_base_of_v<cutlass::gemm::KernelMultistage, typename CollectiveMainloop_::DispatchPolicy::Schedule>, void>::type>::operator()(const cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileScheduler_, typename std::enable_if<is_base_of_v<cutlass::gemm::KernelMultistage, typename CollectiveMainloop_::DispatchPolicy::Schedule>, void>::type>::Params&, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm70_gemm.hpp:210:26: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  210 |     int thread_idx = int(threadIdx.x);
      |                          ^~~~~~~~~
      |                          thread_idx
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm70_gemm.hpp:212:59: error: ‘blockIdx’ was not declared in this scope
  212 |     auto [m_coord, n_coord, l_coord] = static_cast<uint3>(blockIdx);
      |                                                           ^~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:66,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_tma_warpspecialized.hpp: In member function ‘void cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<disjunction_v<cutlass::detail::is_kernel_tag_of<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedSm100>, cutlass::detail::is_kernel_tag_of<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedBlockScaledSm100> >, void>::type>::operator()(const cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<disjunction_v<cutlass::detail::is_kernel_tag_of<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedSm100>, cutlass::detail::is_kernel_tag_of<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedBlockScaledSm100> >, void>::type>::Params&, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_tma_warpspecialized.hpp:634:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  634 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_tma_warpspecialized.hpp:693:7: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  693 |       __syncwarp();
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:67,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_tma_warpspecialized_mma_transform.hpp: In member function ‘void cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedMmaTransformSm100>, void>::type>::operator()(const cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedMmaTransformSm100>, void>::type>::Params&, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_tma_warpspecialized_mma_transform.hpp:694:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  694 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_tma_warpspecialized_mma_transform.hpp:746:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  746 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_tma_warpspecialized_mma_transform.hpp:827:7: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  827 |       __syncwarp();
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:68,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized.hpp: In member function ‘void cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<disjunction_v<cutlass::detail::is_kernel_tag_of<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelPtrArrayTmaWarpSpecializedSm100>, cutlass::detail::is_kernel_tag_of<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelPtrArrayTmaWarpSpecializedBlockScaledSm100> >, void>::type>::operator()(const cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<disjunction_v<cutlass::detail::is_kernel_tag_of<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelPtrArrayTmaWarpSpecializedSm100>, cutlass::detail::is_kernel_tag_of<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelPtrArrayTmaWarpSpecializedBlockScaledSm100> >, void>::type>::Params&, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized.hpp:688:57: error: ‘SmId’ is not a member of ‘cutlass::arch’
  688 |     int32_t sm_id = static_cast<int32_t>(cutlass::arch::SmId());
      |                                                         ^~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized.hpp:716:15: error: ‘blockIdx’ was not declared in this scope
  716 |       sm_id = blockIdx.x + (blockIdx.y * gridDim.x);
      |               ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized.hpp:716:42: error: ‘gridDim’ was not declared in this scope
  716 |       sm_id = blockIdx.x + (blockIdx.y * gridDim.x);
      |                                          ^~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized.hpp:806:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  806 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized.hpp:891:7: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  891 |       __syncwarp();
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:69,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_tma_warpspecialized_input_transform.hpp: In member function ‘void cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileScheduler_, typename std::enable_if<is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedInputTransformSm100>, void>::type>::operator()(const cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileScheduler_, typename std::enable_if<is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedInputTransformSm100>, void>::type>::Params&, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_tma_warpspecialized_input_transform.hpp:412:35: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  412 |     int thread_idx          = int(threadIdx.x);
      |                                   ^~~~~~~~~
      |                                   thread_idx
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_tma_warpspecialized_input_transform.hpp:695:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  695 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_tma_warpspecialized_input_transform.hpp:818:7: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  818 |       __syncwarp();
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:70,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_input_transform.hpp: In member function ‘void cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileScheduler_, typename std::enable_if<is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelPtrArrayTmaWarpSpecializedInputTransformSm100>, void>::type>::operator()(const cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileScheduler_, typename std::enable_if<is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelPtrArrayTmaWarpSpecializedInputTransformSm100>, void>::type>::Params&, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_input_transform.hpp:430:35: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  430 |     int thread_idx          = int(threadIdx.x);
      |                                   ^~~~~~~~~
      |                                   thread_idx
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_input_transform.hpp:686:72: error: ‘SmId’ is not a member of ‘cutlass::arch’
  686 |           params.hw_info.sm_count, static_cast<int32_t>(cutlass::arch::SmId()));
      |                                                                        ^~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_input_transform.hpp:712:11: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  712 |           __syncwarp();
      |           ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_input_transform.hpp:767:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  767 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_input_transform.hpp:902:7: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  902 |       __syncwarp();
      |       ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_input_transform.hpp:976:125: error: ‘SmId’ is not a member of ‘cutlass::arch’
  976 |           params.epilogue, shared_storage.tensormaps.epilogue, params.hw_info.sm_count, static_cast<int32_t>(cutlass::arch::SmId())));
      |                                                                                                                             ^~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_input_transform.hpp:999:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  999 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_input_transform.hpp:1067:125: error: ‘SmId’ is not a member of ‘cutlass::arch’
 1067 |           params.epilogue, shared_storage.tensormaps.epilogue, params.hw_info.sm_count, static_cast<int32_t>(cutlass::arch::SmId())));
      |                                                                                                                             ^~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:71,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_mma_transform.hpp: In member function ‘void cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelPtrArrayTmaWarpSpecializedMmaTransformSm100>, void>::type>::operator()(const cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelPtrArrayTmaWarpSpecializedMmaTransformSm100>, void>::type>::Params&, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_mma_transform.hpp:718:57: error: ‘SmId’ is not a member of ‘cutlass::arch’
  718 |     int32_t sm_id = static_cast<int32_t>(cutlass::arch::SmId());
      |                                                         ^~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_mma_transform.hpp:746:15: error: ‘blockIdx’ was not declared in this scope
  746 |       sm_id = blockIdx.x + (blockIdx.y * gridDim.x);
      |               ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_mma_transform.hpp:746:42: error: ‘gridDim’ was not declared in this scope
  746 |       sm_id = blockIdx.x + (blockIdx.y * gridDim.x);
      |                                          ^~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_mma_transform.hpp:839:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  839 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_mma_transform.hpp:907:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  907 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized_mma_transform.hpp:999:7: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  999 |       __syncwarp();
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:72,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_sparse_gemm_tma_warpspecialized.hpp: In member function ‘void cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<(is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelSparseTmaWarpSpecializedSm100> || is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelSparseTmaWarpSpecializedBlockScaledSm100>), void>::type>::operator()(const cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<(is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelSparseTmaWarpSpecializedSm100> || is_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelSparseTmaWarpSpecializedBlockScaledSm100>), void>::type>::Params&, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_sparse_gemm_tma_warpspecialized.hpp:673:9: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  673 |         __syncwarp();
      |         ^~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_sparse_gemm_tma_warpspecialized.hpp:732:7: error: there are no arguments to ‘__syncwarp’ that depend on a template parameter, so a declaration of ‘__syncwarp’ must be available [-fpermissive]
  732 |       __syncwarp();
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.hpp:73,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm120_gemm_tma_warpspecialized_cooperative_asymmetric_dma.hpp: In member function ‘void cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<(is_asymmetric_dma_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedCooperativeSparseSm120> || is_asymmetric_dma_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedCooperativeSparseBlockScaledSm120>), void>::type>::operator()(const cutlass::gemm::kernel::GemmUniversal<ProblemShape_, CollectiveMainloop_, CollectiveEpilogue_, TileSchedulerTag_, typename std::enable_if<(is_asymmetric_dma_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedCooperativeSparseSm120> || is_asymmetric_dma_kernel_tag_of_v<typename CollectiveMainloop_::DispatchPolicy::Schedule, cutlass::gemm::KernelTmaWarpSpecializedCooperativeSparseBlockScaledSm120>), void>::type>::Params&, char*)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm120_gemm_tma_warpspecialized_cooperative_asymmetric_dma.hpp:374:26: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  374 |     int thread_idx = int(threadIdx.x);
      |                          ^~~~~~~~~
      |                          thread_idx
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm120_gemm_tma_warpspecialized_cooperative_asymmetric_dma.hpp: In lambda function:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm120_gemm_tma_warpspecialized_cooperative_asymmetric_dma.hpp:512:9: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  512 |         __syncthreads();
      |         ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h: In member function ‘void cutlass::gemm::kernel::GemmUniversal<Mma_, Epilogue_, ThreadblockSwizzle_, void, typename std::enable_if<(!(cute::is_tuple<T>::value || cutlass::gemm::kernel::IsCutlass3ArrayKernel<ProblemShape_>::value)), void>::type>::run_with_swizzle(const cutlass::gemm::kernel::GemmUniversal<Mma_, Epilogue_, ThreadblockSwizzle_, void, typename std::enable_if<(!(cute::is_tuple<T>::value || cutlass::gemm::kernel::IsCutlass3ArrayKernel<ProblemShape_>::value)), void>::type>::Params&, cutlass::gemm::kernel::GemmUniversal<Mma_, Epilogue_, ThreadblockSwizzle_, void, typename std::enable_if<(!(cute::is_tuple<T>::value || cutlass::gemm::kernel::IsCutlass3ArrayKernel<ProblemShape_>::value)), void>::type>::SharedStorage&, cutlass::gemm::kernel::GemmUniversal<Mma_, Epilogue_, ThreadblockSwizzle_, void, typename std::enable_if<(!(cute::is_tuple<T>::value || cutlass::gemm::kernel::IsCutlass3ArrayKernel<ProblemShape_>::value)), void>::type>::ThreadblockSwizzle&)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:514:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  514 |     __syncthreads();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal.h:528:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  528 |     int thread_idx = threadIdx.x;
      |                      ^~~~~~~~~
      |                      thread_idx
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal_streamk.h: In member function ‘typename cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::Mma::IteratorA cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::init_iterator_A(cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::TileWorkDesc&, cutlass::gemm::GemmUniversalMode)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal_streamk.h:663:9: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  663 |         threadIdx.x,
      |         ^~~~~~~~~
      |         thread_idx
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal_streamk.h: In member function ‘typename cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::Mma::IteratorB cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::init_iterator_B(cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::TileWorkDesc&, cutlass::gemm::GemmUniversalMode)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal_streamk.h:692:9: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  692 |         threadIdx.x,
      |         ^~~~~~~~~
      |         thread_idx
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal_streamk.h: In member function ‘void cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::gemm()’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal_streamk.h:1097:7: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
 1097 |       __syncthreads();
      |       ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal_streamk.h: In constructor ‘cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::GemmUniversalStreamk(const cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::Params&, cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage&)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal_streamk.h:1141:18: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
 1141 |       thread_idx(threadIdx.x),
      |                  ^~~~~~~~~
      |                  thread_idx
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_universal_streamk.h:1142:16: error: there are no arguments to ‘__shfl_sync’ that depend on a template parameter, so a declaration of ‘__shfl_sync’ must be available [-fpermissive]
 1142 |       warp_idx(__shfl_sync(0xffffffff, threadIdx.x / 32, 0)),   // broadcast the warp_id computed by lane 0 to ensure dependent code
      |                ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/aligned_buffer.h: At global scope:
/home/less/local/cutlass40/include/cutlass/aligned_buffer.h:83:9: error: declaration of ‘using Array = struct cutlass::Array<T, N>’ changes meaning of ‘Array’ [-fpermissive]
   83 |   using Array = Array<T, N>;
      |         ^~~~~
In file included from /home/less/local/cutlass40/include/cutlass/fast_math.h:45,
                 from /home/less/local/cutlass40/include/cute/numeric/math.hpp:36,
                 from /home/less/local/cutlass40/include/cute/numeric/integral_constant.hpp:33,
                 from /home/less/local/cutlass40/include/cute/container/array.hpp:35,
                 from /home/less/local/cutlass40/include/cute/int_tuple.hpp:34,
                 from /home/less/local/cutlass40/include/cute/layout.hpp:34,
                 from /home/less/local/cutlass40/include/cute/tensor_impl.hpp:45,
                 from /home/less/local/cutlass40/include/cute/tensor.hpp:33,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:8:
/home/less/local/cutlass40/include/cutlass/array.h:51:8: note: ‘Array’ declared here as ‘struct cutlass::Array<T, N>’
   51 | struct Array;
      |        ^~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:60,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/layout/permute.h: In member function ‘cutlass::layout::PermuteBase::LongIndex cutlass::layout::Tensor4DPermuteBMM0213RowMajor<D1>::operator()(cutlass::MatrixCoord) const’:
/home/less/local/cutlass40/include/cutlass/layout/permute.h:318:27: error: ‘blockIdx’ was not declared in this scope
  318 |     Index BMM_batch_idx = blockIdx.z;
      |                           ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/layout/permute.h: In member function ‘cutlass::layout::PermuteBase::LongIndex cutlass::layout::Tensor4DPermuteBMM0213RowMajorInverse<D1>::operator()(cutlass::MatrixCoord) const’:
/home/less/local/cutlass40/include/cutlass/layout/permute.h:381:27: error: ‘blockIdx’ was not declared in this scope
  381 |     Index BMM_batch_idx = blockIdx.z;
      |                           ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/layout/permute.h: In member function ‘cutlass::layout::PermuteBase::LongIndex cutlass::layout::Tensor4DPermuteBMM0321ColumnMajor<D1>::operator()(cutlass::MatrixCoord) const’:
/home/less/local/cutlass40/include/cutlass/layout/permute.h:453:27: error: ‘blockIdx’ was not declared in this scope
  453 |     Index BMM_batch_idx = blockIdx.z;
      |                           ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/layout/permute.h: In member function ‘cutlass::layout::PermuteBase::LongIndex cutlass::layout::Tensor4DPermuteBMM0321ColumnMajorInverse<D1>::operator()(cutlass::MatrixCoord) const’:
/home/less/local/cutlass40/include/cutlass/layout/permute.h:514:27: error: ‘blockIdx’ was not declared in this scope
  514 |     Index BMM_batch_idx = blockIdx.z;
      |                           ^~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:60,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/predicated_tile_iterator.h: At global scope:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/predicated_tile_iterator.h:87:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
   87 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:60,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/predicated_tile_iterator.h:814:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<InterleavedN> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  814 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<InterleavedN> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:60,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/predicated_tile_iterator.h:1088:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorNCxHWx<InterleavedN> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1088 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorNCxHWx<InterleavedN> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h: In member function ‘void cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll>::reduce(int, int, int, void*, const OutputOp&, cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll>::OutputTileIterator, cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll>::OutputTileIterator)’:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:336:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  336 |     __syncthreads();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h: In member function ‘void cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll>::unified(const OutputOp&, cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll>::OutputTileIterator, const AccumulatorTile&, cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll>::OutputTileIterator)’:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:425:7: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  425 |       __syncthreads();  // Dummy (CUDA 11.0)
      |       ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h: In member function ‘void cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll>::operator()(const OutputOp&, cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll>::OutputTileIterator, const AccumulatorTile&, SourceAspect)’:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:495:7: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  495 |       __syncthreads();
      |       ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:500:7: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  500 |       __syncthreads();
      |       ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:54,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm.h: In member function ‘void cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial>::operator()(const cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial>::Params&, cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial>::SharedStorage&)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm.h:238:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread_idx’?
  238 |     int thread_idx = threadIdx.x;
      |                      ^~~~~~~~~
      |                      thread_idx
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_pipelined.h: In function ‘void cutlass::gemm::kernel::GemmPipelined(cutlass::gemm::GemmCoord, cutlass::gemm::GemmCoord, typename Mma::IteratorA::Params, typename Mma::IteratorA::TensorRef, typename Mma::IteratorB::Params, typename Mma::IteratorB::TensorRef, typename Epilogue::Params)’:
/home/less/local/cutlass40/include/cutlass/gemm/kernel/gemm_pipelined.h:97:22: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread0’?
   97 |   int tb_thread_id = threadIdx.x;
      |                      ^~~~~~~~~
      |                      thread0
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h: At global scope:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h:88:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
   88 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h:262:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  262 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h:359:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  359 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h:458:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  458 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h:654:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  654 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h:750:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  750 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:79:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
   79 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:253:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  253 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:374:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  374 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:498:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  498 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:654:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  654 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:762:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  762 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Crosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:871:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandRowMajorInterleaved<cutlass::sizeof_bits<S>::value, InterleavedK> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  871 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandRowMajorInterleaved<cutlass::sizeof_bits<S>::value, InterleavedK> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op.h:1021:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandColumnMajorInterleaved<cutlass::sizeof_bits<S>::value, InterleavedK> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1021 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandColumnMajorInterleaved<cutlass::sizeof_bits<S>::value, InterleavedK> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:141:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value, 64> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  141 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value, 64> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:539:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<32, 32> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  539 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<32, 32> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:907:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value, 32> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  907 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value, 32> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:1311:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value, 16> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1311 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value, 16> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:1714:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value, kCrosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1714 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value, kCrosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:1951:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value, kCrosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1951 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value, kCrosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:2189:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kCrosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 2189 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kCrosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:2753:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kCrosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 2753 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kCrosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:2991:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kCrosswise> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 2991 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kCrosswise> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:3229:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
 3229 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:3530:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
 3530 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:3831:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
 3831 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:4135:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<InterleavedN> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 4135 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<InterleavedN> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator.h:4424:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<signed char, cutlass::layout::TensorNCxHWx<InterleavedN> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 4424 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<signed char, cutlass::layout::TensorNCxHWx<InterleavedN> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm80.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/layout/tensor_op_multiplicand_sm80.h: In member function ‘cutlass::layout::TensorOpMultiplicand64bCrosswise::LongIndex cutlass::layout::TensorOpMultiplicand64bCrosswise::operator()(const TensorCoord&) const’:
/home/less/local/cutlass40/include/cutlass/layout/tensor_op_multiplicand_sm80.h:400:68: warning: suggest parentheses around arithmetic in operand of ‘^’ [-Wparentheses]
  400 |     int bank = ((k_group & 2) << 2) ^ ((s % 2) << 3) + (c % 4) * 2 + (access_s / 4) ^ (k_group & 1);
      |                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/layout/tensor_op_multiplicand_sm80.h: In member function ‘cutlass::layout::TensorOpMultiplicandCrosswise128x4::LongIndex cutlass::layout::TensorOpMultiplicandCrosswise128x4::operator()(const TensorCoord&) const’:
/home/less/local/cutlass40/include/cutlass/layout/tensor_op_multiplicand_sm80.h:943:22: warning: suggest parentheses around arithmetic in operand of ‘^’ [-Wparentheses]
  943 |     Index bank = liq + ((s & 1) * 4) ^ (c & 4);
      |                  ~~~~^~~~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm80.h: At global scope:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm80.h:122:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous64b>’ changes meaning of ‘TensorRef’ [-fpermissive]
  122 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous64b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm80.h:418:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b>’ changes meaning of ‘TensorRef’ [-fpermissive]
  418 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm80.h:644:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b>’ changes meaning of ‘TensorRef’ [-fpermissive]
  644 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm80.h:877:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicand64bCrosswise>’ changes meaning of ‘TensorRef’ [-fpermissive]
  877 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicand64bCrosswise>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm80.h:1193:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1193 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm80.h:1424:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1424 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm80.h:1656:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, Layout_>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1656 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, Layout_>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm80.h:2026:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
 2026 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:38,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm80.h:2253:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
 2253 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op_sm80.h:41,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:121,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h: In constructor ‘cutlass::gemm::warp::detail::FragmentShuffler<ElementMma_, ElementLoad_, NumMmaInstructions, NumElementsInWarpFragment, NumElementsInMmaFragment, cutlass::gemm::Operand::kA, typename std::enable_if<((cutlass::sizeof_bits<T>::value / cutlass::sizeof_bits<S>::value) == 2)>::type>::FragmentShuffler()’:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h:152:34: error: ‘LaneId’ is not a member of ‘cutlass::arch’
  152 |     int lane_id = cutlass::arch::LaneId();
      |                                  ^~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h: In member function ‘cutlass::gemm::warp::detail::FragmentShuffler<ElementMma_, ElementLoad_, NumMmaInstructions, NumElementsInWarpFragment, NumElementsInMmaFragment, cutlass::gemm::Operand::kA, typename std::enable_if<((cutlass::sizeof_bits<T>::value / cutlass::sizeof_bits<S>::value) == 2)>::type>::WarpFragment cutlass::gemm::warp::detail::FragmentShuffler<ElementMma_, ElementLoad_, NumMmaInstructions, NumElementsInWarpFragment, NumElementsInMmaFragment, cutlass::gemm::Operand::kA, typename std::enable_if<((cutlass::sizeof_bits<T>::value / cutlass::sizeof_bits<S>::value) == 2)>::type>::operator()(const WarpFragment&)’:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h:174:25: error: there are no arguments to ‘__shfl_up_sync’ that depend on a template parameter, so a declaration of ‘__shfl_up_sync’ must be available [-fpermissive]
  174 |         uint32_t tmp0 = __shfl_up_sync(0xFFFFFFFF, src_ptr[0], delta_up_);
      |                         ^~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h:175:25: error: there are no arguments to ‘__shfl_down_sync’ that depend on a template parameter, so a declaration of ‘__shfl_down_sync’ must be available [-fpermissive]
  175 |         uint32_t tmp1 = __shfl_down_sync(0xFFFFFFFF, src_ptr[0], delta_down_);
      |                         ^~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h:176:25: error: there are no arguments to ‘__shfl_up_sync’ that depend on a template parameter, so a declaration of ‘__shfl_up_sync’ must be available [-fpermissive]
  176 |         uint32_t tmp2 = __shfl_up_sync(0xFFFFFFFF, src_ptr[1], delta_up_);
      |                         ^~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h:177:25: error: there are no arguments to ‘__shfl_down_sync’ that depend on a template parameter, so a declaration of ‘__shfl_down_sync’ must be available [-fpermissive]
  177 |         uint32_t tmp3 = __shfl_down_sync(0xFFFFFFFF, src_ptr[1], delta_down_);
      |                         ^~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h:180:22: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
  180 |         dst_ptr[0] = __byte_perm(tmp0, tmp2, byte_selector_);
      |                      ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h:181:22: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
  181 |         dst_ptr[1] = __byte_perm(tmp1, tmp3, byte_selector_);
      |                      ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h: In constructor ‘cutlass::gemm::warp::detail::FragmentShuffler<ElementMma_, ElementLoad_, NumMmaInstructions, NumElementsInWarpFragment, NumElementsInMmaFragment, cutlass::gemm::Operand::kB, typename std::enable_if<((cutlass::sizeof_bits<T>::value / cutlass::sizeof_bits<S>::value) == 2)>::type>::FragmentShuffler()’:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h:236:34: error: ‘LaneId’ is not a member of ‘cutlass::arch’
  236 |     int lane_id = cutlass::arch::LaneId();
      |                                  ^~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h: In member function ‘cutlass::gemm::warp::detail::FragmentShuffler<ElementMma_, ElementLoad_, NumMmaInstructions, NumElementsInWarpFragment, NumElementsInMmaFragment, cutlass::gemm::Operand::kB, typename std::enable_if<((cutlass::sizeof_bits<T>::value / cutlass::sizeof_bits<S>::value) == 2)>::type>::WarpFragment cutlass::gemm::warp::detail::FragmentShuffler<ElementMma_, ElementLoad_, NumMmaInstructions, NumElementsInWarpFragment, NumElementsInMmaFragment, cutlass::gemm::Operand::kB, typename std::enable_if<((cutlass::sizeof_bits<T>::value / cutlass::sizeof_bits<S>::value) == 2)>::type>::operator()(const WarpFragment&)’:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h:259:25: error: there are no arguments to ‘__shfl_up_sync’ that depend on a template parameter, so a declaration of ‘__shfl_up_sync’ must be available [-fpermissive]
  259 |         uint32_t tmp0 = __shfl_up_sync(0xFFFFFFFF, src_ptr[0], delta_up_);
      |                         ^~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h:260:25: error: there are no arguments to ‘__shfl_down_sync’ that depend on a template parameter, so a declaration of ‘__shfl_down_sync’ must be available [-fpermissive]
  260 |         uint32_t tmp1 = __shfl_down_sync(0xFFFFFFFF, src_ptr[0], delta_down_);
      |                         ^~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h:263:22: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
  263 |         dst_ptr[0] = __byte_perm(tmp0, tmp1, byte_selector_);
      |                      ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op_sm80.h:373,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:121,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_complex_tensor_op_tile_iterator_sm80.h: At global scope:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_complex_tensor_op_tile_iterator_sm80.h:122:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous128b>’ changes meaning of ‘TensorRef’ [-fpermissive]
  122 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous128b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op_sm80.h:373,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:121,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_complex_tensor_op_tile_iterator_sm80.h:399:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous128b>’ changes meaning of ‘TensorRef’ [-fpermissive]
  399 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous128b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op_sm80.h:373,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:121,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_complex_tensor_op_tile_iterator_sm80.h:624:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous128b>’ changes meaning of ‘TensorRef’ [-fpermissive]
  624 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous128b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op_sm80.h:373,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:121,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_complex_tensor_op_tile_iterator_sm80.h:841:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<cutlass::complex<A>, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  841 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<cutlass::complex<A>, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op_sm80.h:373,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:121,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_complex_tensor_op_tile_iterator_sm80.h:1168:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCrosswise128x4>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1168 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCrosswise128x4>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op_sm80.h:373,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:121,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_complex_tensor_op_tile_iterator_sm80.h:1453:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise128x4>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1453 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise128x4>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op_sm80.h:373,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:121,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_complex_tensor_op_tile_iterator_sm80.h:1679:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise128x4>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1679 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise128x4>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op_sm80.h:373,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:121,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_complex_tensor_op_tile_iterator_sm80.h:1915:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<cutlass::complex<float>, cutlass::layout::TensorOpMultiplicandCongruous64b>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1915 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<cutlass::complex<float>, cutlass::layout::TensorOpMultiplicandCongruous64b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op_sm80.h:373,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_tensor_op.h:121,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_complex_tensor_op_tile_iterator_sm80.h:2224:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<cutlass::complex<float>, cutlass::layout::TensorOpMultiplicand64bCrosswise>’ changes meaning of ‘TensorRef’ [-fpermissive]
 2224 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<cutlass::complex<float>, cutlass::layout::TensorOpMultiplicand64bCrosswise>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h: In member function ‘void cutlass::gemm::threadblock::MmaPipelined<Shape_, IteratorA_, SmemIteratorA_, IteratorB_, SmemIteratorB_, ElementC_, LayoutC_, Policy_, TransformA_, TransformB_, Enable>::gmem_wait()’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:277:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  277 |     __syncthreads();
      |     ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_singlestage.h: In member function ‘void cutlass::gemm::threadblock::MmaSingleStage<Shape_, IteratorA_, SmemIteratorA_, IteratorB_, SmemIteratorB_, ElementC_, LayoutC_, Policy_, Enable>::operator()(int, cutlass::gemm::threadblock::MmaSingleStage<Shape_, IteratorA_, SmemIteratorA_, IteratorB_, SmemIteratorB_, ElementC_, LayoutC_, Policy_, Enable>::FragmentC&, cutlass::gemm::threadblock::MmaSingleStage<Shape_, IteratorA_, SmemIteratorA_, IteratorB_, SmemIteratorB_, ElementC_, LayoutC_, Policy_, Enable>::IteratorA, cutlass::gemm::threadblock::MmaSingleStage<Shape_, IteratorA_, SmemIteratorA_, IteratorB_, SmemIteratorB_, ElementC_, LayoutC_, Policy_, Enable>::IteratorB, const FragmentC&)’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_singlestage.h:217:7: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  217 |       __syncthreads();
      |       ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_singlestage.h:245:7: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  245 |       __syncthreads();
      |       ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h: At global scope:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:206:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementCompute>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, 2, Operator_>::Crosswise_A>, ElementB_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementC_>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, 2, Operator_>::Crosswise_B>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  206 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementCompute>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, 2, Operator_>::Crosswise_A>, ElementB_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementC_>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, 2, Operator_>::Crosswise_B>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:352:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, Shape_::kK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  352 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, Shape_::kK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:503:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementB_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementC_>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, 2, Operator_>::Crosswise_B>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  503 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementB_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementC_>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, 2, Operator_>::Crosswise_B>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:638:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementCompute>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, 2, Operator_>::Crosswise_A>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, Shape_::kK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  638 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementCompute>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, 2, Operator_>::Crosswise_A>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, Shape_::kK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:765:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, cutlass::half_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<16, 64>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<16, 64>, float, LayoutC_, cutlass::arch::OpMultiplyAdd, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  765 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, cutlass::half_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<16, 64>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<16, 64>, float, LayoutC_, cutlass::arch::OpMultiplyAdd, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:904:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, Shape_::kK>, cutlass::half_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<16, Shape_::kK>, float, LayoutC_, cutlass::arch::OpMultiplyAdd, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  904 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, Shape_::kK>, cutlass::half_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<16, Shape_::kK>, float, LayoutC_, cutlass::arch::OpMultiplyAdd, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:1037:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, Shape_::kK>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<16, 64>, float, LayoutC_, cutlass::arch::OpMultiplyAdd, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1037 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, Shape_::kK>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<16, 64>, float, LayoutC_, cutlass::arch::OpMultiplyAdd, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:1156:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, cutlass::half_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<16, 64>, cutlass::half_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<16, Shape_::kK>, float, LayoutC_, cutlass::arch::OpMultiplyAdd, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1156 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, cutlass::half_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<16, 64>, cutlass::half_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<16, Shape_::kK>, float, LayoutC_, cutlass::arch::OpMultiplyAdd, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:1307:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, kInterleavedK>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, kInterleavedK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK, AccumulatorsInRowMajor>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1307 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, kInterleavedK>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, kInterleavedK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK, AccumulatorsInRowMajor>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op_sm70.h:96:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value> >’ changes meaning of ‘TensorRef’ [-fpermissive]
   96 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op_sm70.h:312:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  312 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op_sm70.h:442:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  442 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op_sm70.h:569:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<S>::value> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  569 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<S>::value> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op_sm70.h:785:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<S>::value> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  785 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<S>::value> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op_sm70.h:915:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<S>::value> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  915 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<S>::value> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op_sm70.h:1048:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Shape_::kContiguous> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1048 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Shape_::kContiguous> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op_sm70.h:1265:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Shape_::kRow> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1265 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Shape_::kRow> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_tensor_op_sm70.h:1378:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Shape_::kColumn> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1378 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<S>::value, Shape_::kColumn> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_sm70.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm70.h:124:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  124 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_sm70.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm70.h:439:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<S>::value> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  439 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<S>::value> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_sm70.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm70.h:727:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  727 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<S>::value> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_sm70.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm70.h:949:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<S>::value> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  949 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<S>::value> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_sm70.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm70.h:1168:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, Layout_>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1168 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, Layout_>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_sm70.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm70.h:1527:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kKBlock> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1527 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::VoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kKBlock> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_sm70.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm70.h:1859:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kKBlock> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1859 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kKBlock> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_sm70.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm70.h:2085:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kKBlock> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 2085 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, kKBlock> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_sm70.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm70.h:2301:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, Layout_>’ changes meaning of ‘TensorRef’ [-fpermissive]
 2301 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, Layout_>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_sm70.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:51,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_tensor_op_tile_iterator_sm70.h:2652:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, Layout_>’ changes meaning of ‘TensorRef’ [-fpermissive]
 2652 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, Layout_>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:209:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaVoltaTensorOp<WarpShape_, ElementA_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value>, ElementB_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<ElementCompute>::value>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 16, 4>, 32, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  209 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaVoltaTensorOp<WarpShape_, ElementA_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value>, ElementB_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<ElementCompute>::value>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 16, 4>, 32, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:362:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaVoltaTensorOp<WarpShape_, ElementA_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, Shape_::kK>, ElementB_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 16, 4>, 32, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  362 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaVoltaTensorOp<WarpShape_, ElementA_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, Shape_::kK>, ElementB_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 16, 4>, 32, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:517:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaVoltaTensorOp<WarpShape_, ElementA_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, Shape_::kK>, ElementB_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<ElementCompute>::value>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 16, 4>, 32, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  517 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaVoltaTensorOp<WarpShape_, ElementA_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementB>::value, Shape_::kK>, ElementB_, cutlass::layout::RowMajorVoltaTensorOpMultiplicandBCongruous<cutlass::sizeof_bits<ElementCompute>::value>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 16, 4>, 32, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:57,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm70.h:672:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaVoltaTensorOp<WarpShape_, ElementA_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value>, ElementB_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 16, 4>, 32, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  672 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaVoltaTensorOp<WarpShape_, ElementA_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementB>::value>, ElementB_, cutlass::layout::ColumnMajorVoltaTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 16, 4>, 32, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAdd>, cutlass::MatrixShape<1, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt_tile_iterator.h:117:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  117 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt_tile_iterator.h:327:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  327 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt_tile_iterator.h:580:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  580 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt_tile_iterator.h:790:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  790 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt_tile_iterator.h:1037:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1037 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt_tile_iterator.h:1249:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1249 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt_tile_iterator.h:1468:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<4> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1468 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<4> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_simt_tile_iterator.h:1694:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorInterleaved<4> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1694 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorInterleaved<4> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:61,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_pitch_linear.h:85:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’ changes meaning of ‘TensorRef’ [-fpermissive]
   85 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:61,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_pitch_linear.h:239:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  239 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:61,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_pitch_linear.h:336:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  336 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:85:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous64b>’ changes meaning of ‘TensorRef’ [-fpermissive]
   85 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous64b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:260:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b>’ changes meaning of ‘TensorRef’ [-fpermissive]
  260 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:353:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b>’ changes meaning of ‘TensorRef’ [-fpermissive]
  353 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:449:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicand64bCrosswise>’ changes meaning of ‘TensorRef’ [-fpermissive]
  449 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicand64bCrosswise>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:635:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise>’ changes meaning of ‘TensorRef’ [-fpermissive]
  635 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:728:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise>’ changes meaning of ‘TensorRef’ [-fpermissive]
  728 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:824:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous128b>’ changes meaning of ‘TensorRef’ [-fpermissive]
  824 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCongruous128b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:999:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous128b>’ changes meaning of ‘TensorRef’ [-fpermissive]
  999 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous128b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:1092:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous128b>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1092 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous128b>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:1189:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCrosswise128x4>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1189 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::TensorOpMultiplicandCrosswise128x4>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:1368:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise128x4>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1368 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise128x4>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op_sm80.h:1461:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise128x4>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1461 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise128x4>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/warp/mma_gaussian_complex_tensor_op.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/warp/default_mma_complex_tensor_op.h:40,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/warp/mma_gaussian_complex_tensor_op_tile_iterator_sm80.h:119:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<cutlass::complex<A>, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  119 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<cutlass::complex<A>, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:61,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_multistage.h: In member function ‘void cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable>::gmem_wait()’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_multistage.h:490:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  490 |     __syncthreads();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_multistage.h: In member function ‘void cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable>::gemm_iters(int, cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable>::FragmentC&, cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable>::IteratorA&, cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable>::IteratorB&)’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_multistage.h:666:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  666 |     __syncthreads();
      |     ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h: At global scope:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:197:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, InstructionShape_, cutlass::complex<double>, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous128b, cutlass::complex<double>, cutlass::layout::RowMajorTensorOpMultiplicandCongruous128b, cutlass::complex<double>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  197 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, InstructionShape_, cutlass::complex<double>, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous128b, cutlass::complex<double>, cutlass::layout::RowMajorTensorOpMultiplicandCongruous128b, cutlass::complex<double>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:327:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, InstructionShape_, cutlass::complex<double>, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous128b, cutlass::complex<double>, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise128x4, cutlass::complex<double>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  327 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, InstructionShape_, cutlass::complex<double>, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous128b, cutlass::complex<double>, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise128x4, cutlass::complex<double>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:460:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, InstructionShape_, cutlass::complex<double>, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise128x4, cutlass::complex<double>, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise128x4, cutlass::complex<double>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  460 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, InstructionShape_, cutlass::complex<double>, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise128x4, cutlass::complex<double>, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise128x4, cutlass::complex<double>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:592:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, InstructionShape_, cutlass::complex<double>, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise128x4, cutlass::complex<double>, cutlass::layout::RowMajorTensorOpMultiplicandCongruous128b, cutlass::complex<double>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  592 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, InstructionShape_, cutlass::complex<double>, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise128x4, cutlass::complex<double>, cutlass::layout::RowMajorTensorOpMultiplicandCongruous128b, cutlass::complex<double>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:723:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, cutlass::gemm::GemmShape<16, 8, 8>, cutlass::complex<float>, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b, cutlass::complex<float>, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise, cutlass::complex<float>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  723 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, cutlass::gemm::GemmShape<16, 8, 8>, cutlass::complex<float>, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b, cutlass::complex<float>, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise, cutlass::complex<float>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:853:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, cutlass::gemm::GemmShape<16, 8, 8>, cutlass::complex<float>, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b, cutlass::complex<float>, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b, cutlass::complex<float>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  853 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, cutlass::gemm::GemmShape<16, 8, 8>, cutlass::complex<float>, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b, cutlass::complex<float>, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b, cutlass::complex<float>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:984:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, cutlass::gemm::GemmShape<16, 8, 8>, cutlass::complex<float>, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise, cutlass::complex<float>, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise, cutlass::complex<float>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  984 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, cutlass::gemm::GemmShape<16, 8, 8>, cutlass::complex<float>, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise, cutlass::complex<float>, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise, cutlass::complex<float>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:1115:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, cutlass::gemm::GemmShape<16, 8, 8>, cutlass::complex<float>, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise, cutlass::complex<float>, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b, cutlass::complex<float>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1115 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaComplexTensorOp<WarpShape_, cutlass::gemm::GemmShape<16, 8, 8>, cutlass::complex<float>, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise, cutlass::complex<float>, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b, cutlass::complex<float>, LayoutC_, kTransformA, kTransformB, Operator_>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:1284:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneN, 1> >, 1, kTransformA, kTransformB>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, (Shape_::kK / 32)>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1284 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneN, 1> >, 1, kTransformA, kTransformB>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, (Shape_::kK / 32)>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:1451:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneN, 1> >, 1, kTransformA, kTransformB>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1451 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneN, 1> >, 1, kTransformA, kTransformB>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:1624:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneN, 1> >, 1, kTransformA, kTransformB>, cutlass::MatrixShape<(Shape_::kK / 32), 0>, cutlass::MatrixShape<0, (Shape_::kK / 32)>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1624 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::ColumnMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneN, 1> >, 1, kTransformA, kTransformB>, cutlass::MatrixShape<(Shape_::kK / 32), 0>, cutlass::MatrixShape<0, (Shape_::kK / 32)>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_multistage_mma_complex_core_sm80.h:1794:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneN, 1> >, 1, kTransformA, kTransformB>, cutlass::MatrixShape<(Shape_::kK / 32), 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1794 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, cutlass::complex<B>, cutlass::layout::ColumnMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMultistageMmaComplexCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, cutlass::complex<B>, cutlass::layout::RowMajor, cutlass::complex<C>, cutlass::layout::RowMajor, cutlass::complex<RealElementB>, LayoutC_, cutlass::arch::OpClassSimt, Stages, TransformA, TransformB, Operator_, CacheOpA, CacheOpB>::LaneN, 1> >, 1, kTransformA, kTransformB>, cutlass::MatrixShape<(Shape_::kK / 32), 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:192:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, double, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b, double, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise, double, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  192 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, double, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b, double, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise, double, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:308:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, double, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b, double, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b, double, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  308 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, double, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous64b, double, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b, double, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:422:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, double, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise, double, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise, double, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  422 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, double, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise, double, cutlass::layout::ColumnMajorTensorOpMultiplicand64bCrosswise, double, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:540:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, double, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise, double, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b, double, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  540 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, double, cutlass::layout::RowMajorTensorOpMultiplicand64bCrosswise, double, cutlass::layout::RowMajorTensorOpMultiplicandCongruous64b, double, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:1353:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementCompute>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, Stages, Operator_, false, CacheOpA, CacheOpB>::Crosswise_A>, ElementB_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementC_>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, Stages, Operator_, false, CacheOpA, CacheOpB>::Crosswise_B>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1353 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementCompute>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, Stages, Operator_, false, CacheOpA, CacheOpB>::Crosswise_A>, ElementB_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementC_>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, Stages, Operator_, false, CacheOpA, CacheOpB>::Crosswise_B>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:1491:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, Shape_::kK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1491 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, Shape_::kK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:1632:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementCompute>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, Stages, Operator_, false, CacheOpA, CacheOpB>::Crosswise_A>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, Shape_::kK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1632 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementCompute>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, Stages, Operator_, false, CacheOpA, CacheOpB>::Crosswise_A>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, Shape_::kK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:1772:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementB_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementC_>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, Stages, Operator_, false, CacheOpA, CacheOpB>::Crosswise_B>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1772 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, Shape_::kK>, ElementB_, cutlass::layout::RowMajorTensorOpMultiplicandCongruous<cutlass::sizeof_bits<ElementC_>::value, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassTensorOp, Stages, Operator_, false, CacheOpA, CacheOpB>::Crosswise_B>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:1931:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, kInterleavedK>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, kInterleavedK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK, AccumulatorsInRowMajor>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1931 |   using MmaPolicy = MmaPolicy<MmaTensorOp, MatrixShape<0, 0>,
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<typename cutlass::gemm::warp::DefaultMmaTensorOp<WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementCompute>::value, kInterleavedK>, ElementB_, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<ElementC_>::value, kInterleavedK>, ElementC_, LayoutC_, Operator_, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK, AccumulatorsInRowMajor>::Type, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:2089:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneN, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, (Shape_::kK / 32)>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 2089 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneN, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, (Shape_::kK / 32)>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:2240:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneN, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 2240 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneN, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:2401:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneN, 1> > >, cutlass::MatrixShape<(Shape_::kK / 32), 0>, cutlass::MatrixShape<0, (Shape_::kK / 32)>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 2401 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneN, 1> > >, cutlass::MatrixShape<(Shape_::kK / 32), 0>, cutlass::MatrixShape<0, (Shape_::kK / 32)>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:58,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm80.h:2558:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneN, 1> > >, cutlass::MatrixShape<(Shape_::kK / 32), 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 2558 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<4, 8>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, InstructionShape_, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, Stages, Operator_, false, CacheOpA, CacheOpB>::LaneN, 1> > >, cutlass::MatrixShape<(Shape_::kK / 32), 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), (Shape_::kK / WarpShape_::kK)>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:348:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’ changes meaning of ‘TensorRef’ [-fpermissive]
  348 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:349:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::PitchLinear>’ changes meaning of ‘TensorView’ [-fpermissive]
  349 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::PitchLinear>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:705:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  705 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:706:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
  706 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::ColumnMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:895:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  895 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:896:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
  896 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::RowMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:1084:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::AffineRankN<2> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1084 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::AffineRankN<2> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:1085:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::AffineRankN<2> >’ changes meaning of ‘TensorView’ [-fpermissive]
 1085 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::AffineRankN<2> >’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:1392:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::AffineRank2ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1392 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::AffineRank2ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:1393:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::AffineRank2ColumnMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
 1393 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::AffineRank2ColumnMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:1575:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::AffineRank2RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1575 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::AffineRank2RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:1576:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::AffineRank2RowMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
 1576 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::AffineRank2RowMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:1762:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<kInterleavedK> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1762 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<kInterleavedK> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:1763:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::ColumnMajorInterleaved<kInterleavedK> >’ changes meaning of ‘TensorView’ [-fpermissive]
 1763 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::ColumnMajorInterleaved<kInterleavedK> >’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:1953:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorInterleaved<kInterleavedK> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1953 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorInterleaved<kInterleavedK> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator.h:1954:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::RowMajorInterleaved<kInterleavedK> >’ changes meaning of ‘TensorView’ [-fpermissive]
 1954 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::RowMajorInterleaved<kInterleavedK> >’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:173:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’ changes meaning of ‘TensorRef’ [-fpermissive]
  173 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:174:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::PitchLinear>’ changes meaning of ‘TensorView’ [-fpermissive]
  174 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::PitchLinear>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:432:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  432 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:433:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
  433 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::ColumnMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:650:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  650 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:651:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
  651 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::RowMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:860:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::AffineRankN<2> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  860 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::AffineRankN<2> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:861:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::AffineRankN<2> >’ changes meaning of ‘TensorView’ [-fpermissive]
  861 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::AffineRankN<2> >’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:1111:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::AffineRank2ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1111 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::AffineRank2ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:1112:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::AffineRank2ColumnMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
 1112 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::AffineRank2ColumnMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:1319:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::AffineRank2RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
 1319 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::AffineRank2RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:1320:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::AffineRank2RowMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
 1320 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::AffineRank2RowMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:1527:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<kInterleavedK> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1527 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<kInterleavedK> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:1528:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::ColumnMajorInterleaved<kInterleavedK> >’ changes meaning of ‘TensorView’ [-fpermissive]
 1528 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::ColumnMajorInterleaved<kInterleavedK> >’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:1720:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorInterleaved<kInterleavedK> >’ changes meaning of ‘TensorRef’ [-fpermissive]
 1720 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorInterleaved<kInterleavedK> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator.h:1721:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::RowMajorInterleaved<kInterleavedK> >’ changes meaning of ‘TensorView’ [-fpermissive]
 1721 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::RowMajorInterleaved<kInterleavedK> >’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:43,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator_2dthreadtile.h:98:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’ changes meaning of ‘TensorRef’ [-fpermissive]
   98 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:43,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator_2dthreadtile.h:99:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::PitchLinear>’ changes meaning of ‘TensorView’ [-fpermissive]
   99 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::PitchLinear>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:43,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator_2dthreadtile.h:497:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  497 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:43,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator_2dthreadtile.h:498:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
  498 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::ColumnMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:43,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator_2dthreadtile.h:676:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  676 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:43,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_access_iterator_2dthreadtile.h:677:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
  677 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::RowMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h: In member function ‘void cutlass::transform::thread::Transpose<ElementCount_, cutlass::PitchLinearShape<4, 4>, signed char>::transform(cutlass::transform::thread::Transpose<ElementCount_, cutlass::PitchLinearShape<4, 4>, signed char>::Fragment&, cutlass::transform::thread::Transpose<ElementCount_, cutlass::PitchLinearShape<4, 4>, signed char>::Fragment&)’:
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:81:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   81 |       b0 = __byte_perm(a0, a1, 0x0040);
      |            ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:82:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   82 |       c0 = __byte_perm(a2, a3, 0x0040);
      |            ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:83:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   83 |       b0 = __byte_perm(b0, c0, 0x5410);
      |            ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:85:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   85 |       b1 = __byte_perm(a0, a1, 0x0051);
      |            ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:86:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   86 |       c0 = __byte_perm(a2, a3, 0x0051);
      |            ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:87:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   87 |       b1 = __byte_perm(b1, c0, 0x5410);
      |            ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:89:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   89 |       b2 = __byte_perm(a0, a1, 0x0062);
      |            ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:90:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   90 |       c0 = __byte_perm(a2, a3, 0x0062);
      |            ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:91:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   91 |       b2 = __byte_perm(b2, c0, 0x5410);
      |            ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:93:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   93 |       b3 = __byte_perm(a0, a1, 0x0073);
      |            ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:94:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   94 |       c0 = __byte_perm(a2, a3, 0x0073);
      |            ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/transform/thread/transpose.h:95:12: error: there are no arguments to ‘__byte_perm’ that depend on a template parameter, so a declaration of ‘__byte_perm’ must be available [-fpermissive]
   95 |       b3 = __byte_perm(b3, c0, 0x5410);
      |            ^~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h: At global scope:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:167:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’ changes meaning of ‘TensorRef’ [-fpermissive]
  167 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:168:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::PitchLinear>’ changes meaning of ‘TensorView’ [-fpermissive]
  168 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::PitchLinear>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:420:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  420 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:421:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
  421 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::ColumnMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:617:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  617 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/predicated_tile_iterator_2dthreadtile.h:618:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorView’ [-fpermissive]
  618 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::RowMajor>’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_pitch_linear.h:81:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’ changes meaning of ‘TensorRef’ [-fpermissive]
   81 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_pitch_linear.h:301:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  301 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:49,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_pitch_linear.h:436:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  436 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_pitch_linear_2dthreadtile.h:90:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’ changes meaning of ‘TensorRef’ [-fpermissive]
   90 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::PitchLinear>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_pitch_linear_2dthreadtile.h:281:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajorInterleaved<4> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  281 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajorInterleaved<4> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/transform/threadblock/regular_tile_iterator_pitch_linear_2dthreadtile.h:403:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<4> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  403 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<4> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:230:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  230 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:399:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 1> > >, cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingM, 0>, cutlass::MatrixShape<0, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingN>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  399 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 1> > >, cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingM, 0>, cutlass::MatrixShape<0, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingN>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:564:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 1> > >, cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingM, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  564 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 1> > >, cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingM, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::RowMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:729:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingN>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
  729 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::RowMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 1> > >, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingN>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 1>, ElementA_, cutlass::layout::ColumnMajor, ElementB_, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:1231:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, signed char, cutlass::layout::ColumnMajorInterleaved<4>, signed char, cutlass::layout::RowMajorInterleaved<4>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::ColumnMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 4> >, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1231 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, signed char, cutlass::layout::ColumnMajorInterleaved<4>, signed char, cutlass::layout::RowMajorInterleaved<4>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::ColumnMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 4> >, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:1394:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, signed char, cutlass::layout::ColumnMajorInterleaved<4>, signed char, cutlass::layout::RowMajorInterleaved<4>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::ColumnMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 4> >, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>, cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingM, 0>, cutlass::MatrixShape<0, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingN>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1394 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, signed char, cutlass::layout::ColumnMajorInterleaved<4>, signed char, cutlass::layout::RowMajorInterleaved<4>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::ColumnMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 4> >, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>, cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingM, 0>, cutlass::MatrixShape<0, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingN>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:1553:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, signed char, cutlass::layout::ColumnMajorInterleaved<4>, signed char, cutlass::layout::RowMajorInterleaved<4>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::ColumnMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 4> >, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>, cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingM, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1553 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, signed char, cutlass::layout::ColumnMajorInterleaved<4>, signed char, cutlass::layout::RowMajorInterleaved<4>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::ColumnMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 4> >, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>, cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingM, 0>, cutlass::MatrixShape<0, 0>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::RowMajor, signed char, cutlass::layout::RowMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma.h:48,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:59,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_simt.h:1713:9: error: declaration of ‘using MmaPolicy = struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, signed char, cutlass::layout::ColumnMajorInterleaved<4>, signed char, cutlass::layout::RowMajorInterleaved<4>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::ColumnMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 4> >, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingN>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’ changes meaning of ‘MmaPolicy’ [-fpermissive]
 1713 |   using MmaPolicy = MmaPolicy<
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_pipelined.h:46,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core.h:47,
                 from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/default_mma_core_sm75.h:52,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:56,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/mma_base.h:64:8: note: ‘MmaPolicy’ declared here as ‘struct cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaSimt<WarpShape_, signed char, cutlass::layout::ColumnMajorInterleaved<4>, signed char, cutlass::layout::RowMajorInterleaved<4>, ElementC_, LayoutC_, cutlass::gemm::warp::MmaSimtPolicy<cutlass::MatrixShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::WarpNumThreadsN>, cutlass::layout::ColumnMajorInterleaved<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneLayout>, cutlass::gemm::GemmShape<cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneM, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::LaneN, 4> >, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::kPaddingN>, cutlass::gemm::GemmShape<(Shape_::kM / WarpShape_::kM), (Shape_::kN / WarpShape_::kN), cutlass::gemm::threadblock::DefaultMmaCore<Shape_, WarpShape_, cutlass::gemm::GemmShape<1, 1, 4>, signed char, cutlass::layout::ColumnMajor, signed char, cutlass::layout::ColumnMajor, ElementC_, LayoutC_, cutlass::arch::OpClassSimt, 2, Operator_>::PartitionsK>::kK>’
   64 | struct MmaPolicy {
      |        ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle.h:44,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:61,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h: In function ‘int cutlass::gemm::threadblock::RematerializeThreadIdxX()’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h:50:10: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread’?
   50 |   return threadIdx.x;
      |          ^~~~~~~~~
      |          thread
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h: In function ‘int cutlass::gemm::threadblock::RematerializeThreadIdxY()’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h:56:10: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread’?
   56 |   return threadIdx.y;
      |          ^~~~~~~~~
      |          thread
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h: In function ‘int cutlass::gemm::threadblock::RematerializeThreadIdxZ()’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h:62:10: error: ‘threadIdx’ was not declared in this scope; did you mean ‘thread’?
   62 |   return threadIdx.z;
      |          ^~~~~~~~~
      |          thread
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h: In function ‘int cutlass::gemm::threadblock::RematerializeBlockIdxX()’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h:68:10: error: ‘blockIdx’ was not declared in this scope
   68 |   return blockIdx.x;
      |          ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h: In function ‘int cutlass::gemm::threadblock::RematerializeBlockIdxY()’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h:74:10: error: ‘blockIdx’ was not declared in this scope
   74 |   return blockIdx.y;
      |          ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h: In function ‘int cutlass::gemm::threadblock::RematerializeBlockIdxZ()’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h:80:10: error: ‘blockIdx’ was not declared in this scope
   80 |   return blockIdx.z;
      |          ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h: In function ‘int cutlass::gemm::threadblock::RematerializeBlockDimX()’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h:86:10: error: ‘blockDim’ was not declared in this scope
   86 |   return blockDim.x;
      |          ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h: In function ‘int cutlass::gemm::threadblock::RematerializeBlockDimY()’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h:92:10: error: ‘blockDim’ was not declared in this scope
   92 |   return blockDim.y;
      |          ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h: In function ‘int cutlass::gemm::threadblock::RematerializeBlockDimZ()’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/index_remat.h:98:10: error: ‘blockDim’ was not declared in this scope
   98 |   return blockDim.z;
      |          ^~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:61,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h: In constructor ‘cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::ThreadblockSwizzleStreamK(cutlass::gemm::GemmUniversalMode, cutlass::gemm::GemmCoord, cutlass::gemm::GemmCoord, int, int, int, int, size_t, size_t, size_t, int)’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:159:7: warning: ‘cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::batch_count’ will be initialized after [-Wreorder]
  159 |   int batch_count;
      |       ^~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:144:7: warning:   ‘int cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::reduction_blocks’ [-Wreorder]
  144 |   int reduction_blocks;
      |       ^~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:400:3: warning:   when initialized here [-Wreorder]
  400 |   ThreadblockSwizzleStreamK(
      |   ^~~~~~~~~~~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:144:7: warning: ‘cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::reduction_blocks’ will be initialized after [-Wreorder]
  144 |   int reduction_blocks;
      |       ^~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:140:7: warning:   ‘int cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::dp_blocks’ [-Wreorder]
  140 |   int dp_blocks;                            /// Number of data-parallel thread blocks in the grid
      |       ^~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:400:3: warning:   when initialized here [-Wreorder]
  400 |   ThreadblockSwizzleStreamK(
      |   ^~~~~~~~~~~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:149:7: warning: ‘cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::sk_iters_per_region’ will be initialized after [-Wreorder]
  149 |   int sk_iters_per_region;
      |       ^~~~~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:146:7: warning:   ‘int cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::sk_waves’ [-Wreorder]
  146 |   int sk_waves;
      |       ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:400:3: warning:   when initialized here [-Wreorder]
  400 |   ThreadblockSwizzleStreamK(
      |   ^~~~~~~~~~~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:146:7: warning: ‘cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::sk_waves’ will be initialized after [-Wreorder]
  146 |   int sk_waves;
      |       ^~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:135:7: warning:   ‘int cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::sm_occupancy’ [-Wreorder]
  135 |   int sm_occupancy;
      |       ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:400:3: warning:   when initialized here [-Wreorder]
  400 |   ThreadblockSwizzleStreamK(
      |   ^~~~~~~~~~~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:135:7: warning: ‘cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::sm_occupancy’ will be initialized after [-Wreorder]
  135 |   int sm_occupancy;
      |       ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:132:8: warning:   ‘bool cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::remap_block_indices’ [-Wreorder]
  132 |   bool remap_block_indices;
      |        ^~~~~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:400:3: warning:   when initialized here [-Wreorder]
  400 |   ThreadblockSwizzleStreamK(
      |   ^~~~~~~~~~~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:138:7: warning: ‘cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::avail_sms’ will be initialized after [-Wreorder]
  138 |   int avail_sms;
      |       ^~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:129:8: warning:   ‘bool cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::cohort_raster’ [-Wreorder]
  129 |   bool cohort_raster;
      |        ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:400:3: warning:   when initialized here [-Wreorder]
  400 |   ThreadblockSwizzleStreamK(
      |   ^~~~~~~~~~~~~~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle.h:45,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:61,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h: In member function ‘int cutlass::gemm::threadblock::ThreadblockSwizzleStreamK::device_num_blocks() const’:
/home/less/local/cutlass40/include/cutlass/gemm/threadblock/threadblock_swizzle_streamk.h:641:12: error: ‘gridDim’ was not declared in this scope
  641 |     return gridDim.x;
      |            ^~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_tensor_op.h: At global scope:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_tensor_op.h:78:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
   78 |   using TensorRef = TensorRef<Element, Layout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_tensor_op.h:257:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<InterleavedK> >’ changes meaning of ‘TensorRef’ [-fpermissive]
  257 |   using TensorRef = TensorRef<Element, TensorLayout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::ColumnMajorInterleaved<InterleavedK> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_tensor_op.h:453:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, Layout_>’ changes meaning of ‘TensorRef’ [-fpermissive]
  453 |   using TensorRef = TensorRef<Element, Layout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, Layout_>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:66,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_tensor_op_mixed.h:79:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
   79 |   using TensorRef = TensorRef<Element, Layout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:66,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_tensor_op_mixed.h:326:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<int, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  326 |   using TensorRef = TensorRef<Element, Layout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<int, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:66,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_tensor_op_mixed.h:527:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<int, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  527 |   using TensorRef = TensorRef<Element, Layout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<int, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:66,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_tensor_op_mixed.h:716:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<float, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  716 |   using TensorRef = TensorRef<Element, Layout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<float, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:66,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_tensor_op_mixed.h:911:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<float, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  911 |   using TensorRef = TensorRef<Element, Layout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<float, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:69,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/predicated_tile_iterator_conv.h:95:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, typename std::conditional<(kRank == 4), cutlass::layout::TensorNHWC, cutlass::layout::TensorNDHWC>::type>’ changes meaning of ‘TensorRef’ [-fpermissive]
   95 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, typename std::conditional<(kRank == 4), cutlass::layout::TensorNHWC, cutlass::layout::TensorNDHWC>::type>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:70,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/predicated_tile_iterator_strided_dgrad.h:82:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
   82 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:71,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/predicated_tile_iterator_affine.h:86:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::AffineRankN<Rank> >’ changes meaning of ‘TensorRef’ [-fpermissive]
   86 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::AffineRankN<Rank> >’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:71,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/predicated_tile_iterator_affine.h:87:9: error: declaration of ‘using TensorView = class cutlass::TensorView<Element_, cutlass::layout::AffineRankN<Rank> >’ changes meaning of ‘TensorView’ [-fpermissive]
   87 |   using TensorView = TensorView<Element, Layout>;
      |         ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:43,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_view.h:62:7: note: ‘TensorView’ declared here as ‘class cutlass::TensorView<Element_, cutlass::layout::AffineRankN<Rank> >’
   62 | class TensorView : public TensorRef<Element_, Layout_> {
      |       ^~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:72,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/shared_load_iterator.h:75:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
   75 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:73,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/shared_load_iterator_mixed.h:97:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
   97 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:73,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/shared_load_iterator_mixed.h:269:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  269 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:73,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/shared_load_iterator_mixed.h:438:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  438 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h:76,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:63,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/interleaved_epilogue.h: In member function ‘void cutlass::epilogue::threadblock::InterleavedEpilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, OutputOp_, InterleavedK>::unified(const OutputOp&, cutlass::epilogue::threadblock::InterleavedEpilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, OutputOp_, InterleavedK>::OutputTileIterator, const AccumulatorTile&, cutlass::epilogue::threadblock::InterleavedEpilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, OutputOp_, InterleavedK>::OutputTileIterator)’:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/interleaved_epilogue.h:345:7: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  345 |       __syncthreads();  // Dummy (CUDA 11.0)
      |       ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_volta_tensor_op.h:64,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:64,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_volta_tensor_op.h: At global scope:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_volta_tensor_op.h:75:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<cutlass::half_t, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
   75 |   using TensorRef = TensorRef<Element, Layout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<cutlass::half_t, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_volta_tensor_op.h:64,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:64,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_volta_tensor_op.h:266:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<float, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  266 |   using TensorRef = TensorRef<Element, Layout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<float, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_simt.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_simt.h:80:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
   80 |   using TensorRef = TensorRef<Element, Layout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_simt.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_simt.h:269:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  269 |   using TensorRef = TensorRef<Element, Layout>;  ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_simt.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_simt.h:429:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
  429 |   using TensorRef = TensorRef<Element, Layout>;  ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_simt.h:62,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/warp/tile_iterator_simt.h:554:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, Layout_>’ changes meaning of ‘TensorRef’ [-fpermissive]
  554 |   using TensorRef = TensorRef<Element, Layout>;         ///< Tensor Reference object
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, Layout_>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_simt.h:70,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/predicated_tile_iterator_direct_conv.h:87:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
   87 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_simt.h:72,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/shared_load_iterator_pitch_linear.h:75:9: error: declaration of ‘using TensorRef = class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’ changes meaning of ‘TensorRef’ [-fpermissive]
   75 |   using TensorRef = TensorRef<Element, Layout>;
      |         ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/transform/pitch_linear_thread_map.h:42,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue.h:55,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:50,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/tensor_ref.h:152:7: note: ‘TensorRef’ declared here as ‘class cutlass::TensorRef<Element_, cutlass::layout::RowMajor>’
  152 | class TensorRef {
      |       ^~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/threadblock/default_epilogue_simt.h:74,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm.h:65,
                 from /home/less/local/cutlass40/include/cutlass/gemm/kernel/default_gemm_universal.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:53,
                 from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_depthwise.h: In member function ‘void cutlass::epilogue::threadblock::EpilogueDepthwise<Shape_, ThreadOutputShape_, ThreadBlockOutputShape_, WarpMmaOperator_, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_>::compute_source_needed_(const OutputOp&, cutlass::epilogue::threadblock::EpilogueDepthwise<Shape_, ThreadOutputShape_, ThreadBlockOutputShape_, WarpMmaOperator_, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_>::OutputTileIterator, const AccumulatorTile&, cutlass::epilogue::threadblock::EpilogueDepthwise<Shape_, ThreadOutputShape_, ThreadBlockOutputShape_, WarpMmaOperator_, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_>::OutputTileIterator)’:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_depthwise.h:240:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  240 |     __syncthreads();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_depthwise.h: In member function ‘void cutlass::epilogue::threadblock::EpilogueDepthwise<Shape_, ThreadOutputShape_, ThreadBlockOutputShape_, WarpMmaOperator_, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_>::compute_source_not_needed_(const OutputOp&, cutlass::epilogue::threadblock::EpilogueDepthwise<Shape_, ThreadOutputShape_, ThreadBlockOutputShape_, WarpMmaOperator_, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_>::OutputTileIterator, const AccumulatorTile&)’:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_depthwise.h:265:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  265 |     __syncthreads();
      |     ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:54,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h: In member function ‘cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::run(cudaStream_t, cutlass::CudaHostAdapter*)’:
/home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:461:28: error: expected primary-expression before ‘<’ token
  461 |       Kernel2<GemmKernel><<<grid, block, kSharedStorageSize, stream>>>(params_);
      |                            ^
/home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_base.h:461:70: error: expected primary-expression before ‘>’ token
  461 |       Kernel2<GemmKernel><<<grid, block, kSharedStorageSize, stream>>>(params_);
      |                                                                      ^
In file included from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:57,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h: At global scope:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h:124:11: error: declaration of ‘using ElementAccumulator = using ElementAccumulator = typename DefaultEpilogue::WarpTileIterator::Element’ changes meaning of ‘ElementAccumulator’ [-fpermissive]
  124 |     using ElementAccumulator = ElementAccumulator;
      |           ^~~~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h:121:9: note: ‘ElementAccumulator’ declared here as ‘using ElementAccumulator = typename DefaultEpilogue::WarpTileIterator::Element’
  121 |   using ElementAccumulator = typename WarpTileIterator::Element;
      |         ^~~~~~~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:57,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:14:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h: In member function ‘void cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::reduce(int, int, int, void*, cutlass::gemm::GemmCoord, ProblemShape, int)’:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h:201:5: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  201 |     __syncthreads();
      |     ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h: In member function ‘void cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::operator()(const AccumulatorTile&, cutlass::gemm::GemmCoord, ProblemShape, int)’:
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h:287:7: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  287 |       __syncthreads();
      |       ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h:315:9: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  315 |         __syncthreads();
      |         ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h:412:9: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  412 |         __syncthreads();
      |         ^~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h:417:9: error: there are no arguments to ‘__syncthreads’ that depend on a template parameter, so a declaration of ‘__syncthreads’ must be available [-fpermissive]
  417 |         __syncthreads();
      |         ^~~~~~~~~~~~~
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:122,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm100_builder.inl: In instantiation of ‘struct cutlass::epilogue::collective::detail::Sm100TmaBuilderImpl<cutlass::arch::OpClassTensorOp, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> >, cutlass::epilogue::collective::EpilogueTileAuto, float, float, cutlass::half_t, cutlass::layout::ColumnMajor*, 8, cutlass::half_t, cutlass::layout::ColumnMajor*, 8, cutlass::epilogue::PtrArrayTmaWarpSpecialized2Sm, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float> >’:
/home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm100_builder.inl:1422:9:   required from ‘struct cutlass::epilogue::collective::CollectiveBuilder<cutlass::arch::Sm100, cutlass::arch::OpClassTensorOp, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> >, cutlass::epilogue::collective::EpilogueTileAuto, float, float, cutlass::half_t, cutlass::layout::ColumnMajor*, 8, cutlass::half_t, cutlass::layout::ColumnMajor*, 8, cutlass::epilogue::PtrArrayTmaWarpSpecialized2Sm, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float>, void>’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:62:9:   required from ‘struct GemmBuilder<MMA2SMConfig>’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:88:51:   required from here
/home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm100_builder.inl:983:17: error: static assertion failed: schedule + cluster mismatch
  983 |   static_assert(not (Is2SmMma && size<0>(ClusterShape_MNK{}) % 2 == 1), "schedule + cluster mismatch");
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm100_builder.inl:983:17: note: ‘((!(bool)cutlass::epilogue::collective::detail::Sm100TmaBuilderImpl<cutlass::arch::OpClassTensorOp, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> >, cutlass::epilogue::collective::EpilogueTileAuto, float, float, cutlass::half_t, cutlass::layout::ColumnMajor*, 8, cutlass::half_t, cutlass::layout::ColumnMajor*, 8, cutlass::epilogue::PtrArrayTmaWarpSpecialized2Sm, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float> >::Is2SmMma) || ((cute::size<0, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >(cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> >()).cute::C<1>::operator cute::C<1>::value_type() % 2) != 1))’ evaluates to false
In file included from /home/less/local/cutlass40/include/cutlass/epilogue/collective/builders/sm100_builder.inl:44,
                 from /home/less/local/cutlass40/include/cutlass/epilogue/collective/collective_builder.hpp:122,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:10:
/home/less/local/cutlass40/include/cutlass/gemm/collective/builders/sm100_common.inl: In instantiation of ‘constexpr auto cutlass::gemm::collective::detail::sm100_cluster_shape_to_tma_atom_A(ClusterShapeMNK, AtomThrId) [with ClusterShapeMNK = cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> >; AtomThrId = cute::Layout<cute::C<2>, cute::C<1> >]’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/builders/sm100_umma_builder.inl:245:103:   required from ‘struct cutlass::gemm::collective::CollectiveBuilder<cutlass::arch::Sm100, cutlass::arch::OpClassTensorOp, cutlass::float_e4m3_t, cutlass::layout::RowMajor*, 16, cutlass::float_e4m3_t, cutlass::layout::ColumnMajor*, 16, float, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> >, cutlass::gemm::collective::StageCountAutoCarveout<67584>, cutlass::gemm::KernelPtrArrayTmaWarpSpecialized2SmSm100, void>’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:71:9:   required from ‘struct GemmBuilder<MMA2SMConfig>’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:88:51:   required from here
/home/less/local/cutlass40/include/cutlass/gemm/collective/builders/sm100_common.inl:205:58: error: static assertion failed: Cluster shape not divisible by MMA size
  205 |       static_assert(cute::size<0>(cluster_shape_mnk) % 2 == 0, "Cluster shape not divisible by MMA size");
      |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/builders/sm100_common.inl:205:58: note: ‘((cute::size<0, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >(cluster_shape_mnk).cute::C<1>::operator cute::C<1>::value_type() % 2) == 0)’ evaluates to false
/home/less/local/cutlass40/include/cutlass/gemm/collective/builders/sm100_common.inl: In instantiation of ‘constexpr auto cutlass::gemm::collective::detail::sm100_cluster_shape_to_tma_atom_B(ClusterShapeMNK, AtomThrId) [with ClusterShapeMNK = cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> >; AtomThrId = cute::Layout<cute::C<2>, cute::C<1> >]’:
/home/less/local/cutlass40/include/cutlass/gemm/collective/builders/sm100_umma_builder.inl:247:103:   required from ‘struct cutlass::gemm::collective::CollectiveBuilder<cutlass::arch::Sm100, cutlass::arch::OpClassTensorOp, cutlass::float_e4m3_t, cutlass::layout::RowMajor*, 16, cutlass::float_e4m3_t, cutlass::layout::ColumnMajor*, 16, float, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> >, cutlass::gemm::collective::StageCountAutoCarveout<67584>, cutlass::gemm::KernelPtrArrayTmaWarpSpecialized2SmSm100, void>’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:71:9:   required from ‘struct GemmBuilder<MMA2SMConfig>’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:88:51:   required from here
/home/less/local/cutlass40/include/cutlass/gemm/collective/builders/sm100_common.inl:241:58: error: static assertion failed: Cluster shape not divisible by MMA size
  241 |       static_assert(cute::size<0>(cluster_shape_mnk) % 2 == 0, "Cluster shape not divisible by MMA size");
      |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~
/home/less/local/cutlass40/include/cutlass/gemm/collective/builders/sm100_common.inl:241:58: note: ‘((cute::size<0, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >(cluster_shape_mnk).cute::C<1>::operator cute::C<1>::value_type() % 2) == 0)’ evaluates to false
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp: In function ‘at::Tensor run_grouped_gemm(const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<float, std::allocator<float> >&, const std::vector<float, std::allocator<float> >&, int)’:
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:131:12: error: ‘cutlass::device_memory’ has not been declared
  131 |   cutlass::device_memory::allocation<
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:132:52: error: expected ‘(’ before ‘>’ token
  132 |       typename ProblemShape::UnderlyingProblemShape>
      |                                                    ^
      |                                                    (
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:133:7: error: there are no arguments to ‘problem_sizes’ that depend on a template parameter, so a declaration of ‘problem_sizes’ must be available [-fpermissive]
  133 |       problem_sizes(groups);
      |       ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:134:3: error: ‘problem_sizes’ was not declared in this scope; did you mean ‘problem_sizes_host’?
  134 |   problem_sizes.copy_from_host(problem_sizes_host.data());
      |   ^~~~~~~~~~~~~
      |   problem_sizes_host
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:149:12: error: ‘cutlass::device_memory’ has not been declared
  149 |   cutlass::device_memory::allocation<const ElementA *> ptr_A(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:149:38: error: expected primary-expression before ‘const’
  149 |   cutlass::device_memory::allocation<const ElementA *> ptr_A(groups);
      |                                      ^~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:150:12: error: ‘cutlass::device_memory’ has not been declared
  150 |   cutlass::device_memory::allocation<const ElementB *> ptr_B(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:150:38: error: expected primary-expression before ‘const’
  150 |   cutlass::device_memory::allocation<const ElementB *> ptr_B(groups);
      |                                      ^~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:151:12: error: ‘cutlass::device_memory’ has not been declared
  151 |   cutlass::device_memory::allocation<const ElementC *> ptr_C(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:151:38: error: expected primary-expression before ‘const’
  151 |   cutlass::device_memory::allocation<const ElementC *> ptr_C(groups);
      |                                      ^~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:152:12: error: ‘cutlass::device_memory’ has not been declared
  152 |   cutlass::device_memory::allocation<ElementC *> ptr_D(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:152:47: error: expected primary-expression before ‘*’ token
  152 |   cutlass::device_memory::allocation<ElementC *> ptr_D(groups);
      |                                               ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:152:48: error: expected primary-expression before ‘>’ token
  152 |   cutlass::device_memory::allocation<ElementC *> ptr_D(groups);
      |                                                ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:152:50: error: there are no arguments to ‘ptr_D’ that depend on a template parameter, so a declaration of ‘ptr_D’ must be available [-fpermissive]
  152 |   cutlass::device_memory::allocation<ElementC *> ptr_D(groups);
      |                                                  ^~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:154:3: error: ‘ptr_A’ was not declared in this scope
  154 |   ptr_A.copy_from_host(ptr_A_host.data());
      |   ^~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:155:3: error: ‘ptr_B’ was not declared in this scope
  155 |   ptr_B.copy_from_host(ptr_B_host.data());
      |   ^~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:156:3: error: ‘ptr_C’ was not declared in this scope
  156 |   ptr_C.copy_from_host(ptr_C_host.data());
      |   ^~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:157:3: error: ‘ptr_D’ was not declared in this scope
  157 |   ptr_D.copy_from_host(ptr_D_host.data());
      |   ^~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:177:18: error: ‘make_cute_packed_stride’ is not a member of ‘cutlass’
  177 |         cutlass::make_cute_packed_stride(StrideA{}, cute::make_shape(M, K, 1)));
      |                  ^~~~~~~~~~~~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:179:18: error: ‘make_cute_packed_stride’ is not a member of ‘cutlass’
  179 |         cutlass::make_cute_packed_stride(StrideB{}, cute::make_shape(N, K, 1)));
      |                  ^~~~~~~~~~~~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:181:18: error: ‘make_cute_packed_stride’ is not a member of ‘cutlass’
  181 |         cutlass::make_cute_packed_stride(StrideC{}, cute::make_shape(M, N, 1)));
      |                  ^~~~~~~~~~~~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:183:18: error: ‘make_cute_packed_stride’ is not a member of ‘cutlass’
  183 |         cutlass::make_cute_packed_stride(StrideD{}, cute::make_shape(M, N, 1)));
      |                  ^~~~~~~~~~~~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:186:12: error: ‘cutlass::device_memory’ has not been declared
  186 |   cutlass::device_memory::allocation<StrideA> stride_A(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:186:45: error: expected primary-expression before ‘>’ token
  186 |   cutlass::device_memory::allocation<StrideA> stride_A(groups);
      |                                             ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:186:47: error: there are no arguments to ‘stride_A’ that depend on a template parameter, so a declaration of ‘stride_A’ must be available [-fpermissive]
  186 |   cutlass::device_memory::allocation<StrideA> stride_A(groups);
      |                                               ^~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:187:12: error: ‘cutlass::device_memory’ has not been declared
  187 |   cutlass::device_memory::allocation<StrideB> stride_B(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:187:45: error: expected primary-expression before ‘>’ token
  187 |   cutlass::device_memory::allocation<StrideB> stride_B(groups);
      |                                             ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:187:47: error: there are no arguments to ‘stride_B’ that depend on a template parameter, so a declaration of ‘stride_B’ must be available [-fpermissive]
  187 |   cutlass::device_memory::allocation<StrideB> stride_B(groups);
      |                                               ^~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:188:12: error: ‘cutlass::device_memory’ has not been declared
  188 |   cutlass::device_memory::allocation<StrideC> stride_C(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:188:45: error: expected primary-expression before ‘>’ token
  188 |   cutlass::device_memory::allocation<StrideC> stride_C(groups);
      |                                             ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:188:47: error: there are no arguments to ‘stride_C’ that depend on a template parameter, so a declaration of ‘stride_C’ must be available [-fpermissive]
  188 |   cutlass::device_memory::allocation<StrideC> stride_C(groups);
      |                                               ^~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:189:12: error: ‘cutlass::device_memory’ has not been declared
  189 |   cutlass::device_memory::allocation<StrideD> stride_D(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:189:45: error: expected primary-expression before ‘>’ token
  189 |   cutlass::device_memory::allocation<StrideD> stride_D(groups);
      |                                             ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:189:47: error: there are no arguments to ‘stride_D’ that depend on a template parameter, so a declaration of ‘stride_D’ must be available [-fpermissive]
  189 |   cutlass::device_memory::allocation<StrideD> stride_D(groups);
      |                                               ^~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:191:3: error: ‘stride_A’ was not declared in this scope; did you mean ‘StrideA’?
  191 |   stride_A.copy_from_host(stride_A_host.data());
      |   ^~~~~~~~
      |   StrideA
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:192:3: error: ‘stride_B’ was not declared in this scope; did you mean ‘StrideB’?
  192 |   stride_B.copy_from_host(stride_B_host.data());
      |   ^~~~~~~~
      |   StrideB
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:193:3: error: ‘stride_C’ was not declared in this scope; did you mean ‘StrideC’?
  193 |   stride_C.copy_from_host(stride_C_host.data());
      |   ^~~~~~~~
      |   StrideC
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:194:3: error: ‘stride_D’ was not declared in this scope; did you mean ‘StrideD’?
  194 |   stride_D.copy_from_host(stride_D_host.data());
      |   ^~~~~~~~
      |   StrideD
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:197:12: error: ‘cutlass::device_memory’ has not been declared
  197 |   cutlass::device_memory::allocation<ElementAccumulator> block_alpha(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:197:56: error: expected primary-expression before ‘>’ token
  197 |   cutlass::device_memory::allocation<ElementAccumulator> block_alpha(groups);
      |                                                        ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:197:58: error: there are no arguments to ‘block_alpha’ that depend on a template parameter, so a declaration of ‘block_alpha’ must be available [-fpermissive]
  197 |   cutlass::device_memory::allocation<ElementAccumulator> block_alpha(groups);
      |                                                          ^~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:198:12: error: ‘cutlass::device_memory’ has not been declared
  198 |   cutlass::device_memory::allocation<ElementAccumulator> block_beta(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:198:56: error: expected primary-expression before ‘>’ token
  198 |   cutlass::device_memory::allocation<ElementAccumulator> block_beta(groups);
      |                                                        ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:198:58: error: there are no arguments to ‘block_beta’ that depend on a template parameter, so a declaration of ‘block_beta’ must be available [-fpermissive]
  198 |   cutlass::device_memory::allocation<ElementAccumulator> block_beta(groups);
      |                                                          ^~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:205:3: error: ‘block_alpha’ was not declared in this scope
  205 |   block_alpha.copy_from_host(alpha_host.data());
      |   ^~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:206:3: error: ‘block_beta’ was not declared in this scope; did you mean ‘clock_t’?
  206 |   block_beta.copy_from_host(beta_host.data());
      |   ^~~~~~~~~~
      |   clock_t
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:216:12: error: ‘cutlass::device_memory’ has not been declared
  216 |   cutlass::device_memory::allocation<ElementAccumulator *> alpha_device(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:216:57: error: expected primary-expression before ‘*’ token
  216 |   cutlass::device_memory::allocation<ElementAccumulator *> alpha_device(groups);
      |                                                         ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:216:58: error: expected primary-expression before ‘>’ token
  216 |   cutlass::device_memory::allocation<ElementAccumulator *> alpha_device(groups);
      |                                                          ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:216:60: error: there are no arguments to ‘alpha_device’ that depend on a template parameter, so a declaration of ‘alpha_device’ must be available [-fpermissive]
  216 |   cutlass::device_memory::allocation<ElementAccumulator *> alpha_device(groups);
      |                                                            ^~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:217:12: error: ‘cutlass::device_memory’ has not been declared
  217 |   cutlass::device_memory::allocation<ElementAccumulator *> beta_device(groups);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:217:57: error: expected primary-expression before ‘*’ token
  217 |   cutlass::device_memory::allocation<ElementAccumulator *> beta_device(groups);
      |                                                         ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:217:58: error: expected primary-expression before ‘>’ token
  217 |   cutlass::device_memory::allocation<ElementAccumulator *> beta_device(groups);
      |                                                          ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:217:60: error: there are no arguments to ‘beta_device’ that depend on a template parameter, so a declaration of ‘beta_device’ must be available [-fpermissive]
  217 |   cutlass::device_memory::allocation<ElementAccumulator *> beta_device(groups);
      |                                                            ^~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:219:3: error: ‘alpha_device’ was not declared in this scope
  219 |   alpha_device.copy_from_host(ptr_alpha_host.data());
      |   ^~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:220:3: error: ‘beta_device’ was not declared in this scope
  220 |   beta_device.copy_from_host(ptr_beta_host.data());
      |   ^~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:270:12: error: ‘cutlass::device_memory’ has not been declared
  270 |   cutlass::device_memory::allocation<uint8_t> workspace(workspace_size);
      |            ^~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:270:45: error: expected primary-expression before ‘>’ token
  270 |   cutlass::device_memory::allocation<uint8_t> workspace(workspace_size);
      |                                             ^
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:270:47: error: there are no arguments to ‘workspace’ that depend on a template parameter, so a declaration of ‘workspace’ must be available [-fpermissive]
  270 |   cutlass::device_memory::allocation<uint8_t> workspace(workspace_size);
      |                                               ^~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:274:44: error: ‘workspace’ was not declared in this scope; did you mean ‘c10::attr::workspace’?
  274 |   CUTLASS_CHECK(gemm.initialize(arguments, workspace.get()));
      |                                            ^~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:101:9: note: in definition of macro ‘CUTLASS_CHECK’
  101 |     if (status != cutlass::Status::kSuccess) {                                 \
      |         ^~~~~~
In file included from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/ir/ir.h:18,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/method.h:7,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/object.h:5,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/module.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/serialize/input-archive.h:5,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/samplers/serialize.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/samplers.h:8,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/datasets/chunk.h:6,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/extension.h:5,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:3:
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/aten_interned_strings.h:2281:9: note: ‘c10::attr::workspace’ declared here
 2281 | _(attr, workspace) \
      |         ^~~~~~~~~
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/interned_strings.h:351:35: note: in definition of macro ‘DEFINE_SYMBOL’
  351 |   namespace ns { constexpr Symbol s(static_cast<unique_t>(_keys::ns##_##s)); }
      |                                   ^
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/interned_strings.h:298:3: note: in expansion of macro ‘FORALL_ATTR_BASE_SYMBOLS’
  298 |   FORALL_ATTR_BASE_SYMBOLS(_)        \
      |   ^~~~~~~~~~~~~~~~~~~~~~~~
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/interned_strings.h:352:1: note: in expansion of macro ‘FORALL_NS_SYMBOLS’
  352 | FORALL_NS_SYMBOLS(DEFINE_SYMBOL)
      | ^~~~~~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp: In instantiation of ‘at::Tensor run_grouped_gemm(const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<float, std::allocator<float> >&, const std::vector<float, std::allocator<float> >&, int) [with Gemm = cutlass::gemm::device::GemmUniversalAdapter<cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>, void>]’:
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:352:37:   required from here
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:133:20: error: ‘problem_sizes’ was not declared in this scope; did you mean ‘problem_sizes_host’?
  133 |       problem_sizes(groups);
      |       ~~~~~~~~~~~~~^~~~~~~~
      |       problem_sizes_host
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:152:55: error: ‘ptr_D’ was not declared in this scope
  152 |   cutlass::device_memory::allocation<ElementC *> ptr_D(groups);
      |                                                  ~~~~~^~~~~~~~
In file included from /home/less/local/cutlass40/include/cute/atom/copy_atom.hpp:756,
                 from /home/less/local/cutlass40/include/cute/algorithm/copy.hpp:36,
                 from /home/less/local/cutlass40/include/cute/tensor.hpp:51,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:8:
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp: In instantiation of ‘auto cute::detail::make_tma_copy_desc(const cute::Tensor<Engine, Layout>&, const cute::Layout<NewShape, NewStride>&, const cute::Swizzle<B1, M1, S1>&, uint32_t) [with TmaInternalType = cutlass::float_e4m3_t; GEngine = cute::ViewEngine<cutlass::float_e4m3_t*>; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<long int, cute::C<1>, cute::C<0> > >; TShape = cute::tuple<cute::C<128>, cute::C<128> >; TStride = cute::tuple<cute::ScaledBasis<cute::C<1>, 1>, cute::ScaledBasis<cute::C<1>, 0> >; int B = 3; int M = 4; int S = 3; uint32_t = unsigned int]’:
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:1108:76:   required from ‘auto cute::detail::make_tma_copy_atom(CopyOp, const cute::Tensor<Engine, Layout>&, const SLayout&, const uint32_t&, const cute::Layout<NewShape, NewStride>&) [with TmaInternalType = cutlass::float_e4m3_t; CopyOp = cute::SM100_TMA_2SM_LOAD; GEngine = cute::ViewEngine<cutlass::float_e4m3_t*>; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<long int, cute::C<1>, cute::C<0> > >; SLayout = cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::C<0>, cute::Layout<cute::tuple<cute::tuple<cute::C<128>, cute::C<32> >, cute::C<1>, cute::C<4> >, cute::tuple<cute::tuple<cute::C<128>, cute::C<1> >, cute::C<0>, cute::C<32> > > >; VShape = cute::tuple<cute::tuple<cute::C<128>, cute::C<32> >, cute::C<1>, cute::C<4> >; VStride = cute::tuple<cute::tuple<cute::ScaledBasis<cute::C<1>, 0>, cute::ScaledBasis<cute::C<1>, 1> >, cute::C<0>, cute::ScaledBasis<cute::C<32>, 1> >; uint32_t = unsigned int]’
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm100_tma.hpp:431:45:   required from ‘auto cute::make_tma_atom_A_sm100(const CopyOp&, const cute::Tensor<Engine, Layout>&, const SLayout&, const MMA_Tiler&, const cute::TiledMMA<Args ...>&, const ClusterShapeVMNK&) [with TmaInternalType = cutlass::float_e4m3_t; CopyOp = cute::SM100_TMA_2SM_LOAD; GEngine = cute::ViewEngine<cutlass::float_e4m3_t*>; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<long int, cute::C<1>, cute::C<0> > >; SLayout = cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::C<0>, cute::Layout<cute::tuple<cute::tuple<cute::C<128>, cute::C<32> >, cute::C<1>, cute::C<4> >, cute::tuple<cute::tuple<cute::C<128>, cute::C<1> >, cute::C<0>, cute::C<32> > > >; MMA_Tiler = cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >; Args = {cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> >, cute::tuple<cute::C<0>, cute::C<0>, cute::C<0> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore>}; ClusterShapeVMNK = cute::Layout<cute::tuple<cute::tuple<cute::C<2> >, cute::C<1>, cute::C<1>, cute::C<1> >, cute::tuple<cute::tuple<cute::C<0> >, cute::C<0>, cute::C<0>, cute::C<0> > >]’
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized.hpp:266:70:   required from ‘struct cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>::Params’
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized.hpp:853:33:   required from ‘struct cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>’
/home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:618:97:   recursively required by substitution of ‘template<class GemmKernel> struct cutlass::gemm::detail::IsCutlass3GemmKernel<GemmKernel, std::void_t<typename GemmKernel::ProblemShape> > [with GemmKernel = cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>]’
/home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:618:97:   required by substitution of ‘template<class GemmKernel_> class cutlass::gemm::device::GemmUniversalAdapter<GemmKernel_, typename std::enable_if<(! cutlass::gemm::detail::IsCutlass3GemmKernel<typename cutlass::GetUnderlyingKernel<T>::type>::value), void>::type> [with GemmKernel_ = cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>]’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:160:9:   required from ‘at::Tensor run_grouped_gemm(const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<float, std::allocator<float> >&, const std::vector<float, std::allocator<float> >&, int) [with Gemm = cutlass::gemm::device::GemmUniversalAdapter<cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>, void>]’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:352:37:   required from here
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:908:9: warning: unused variable ‘gmem_address’ [-Wunused-variable]
  908 |   void* gmem_address = (void*) raw_pointer_cast(gtensor_T.data());
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:952:28: warning: unused variable ‘smem_box_stride’ [-Wunused-variable]
  952 |   cute::array<uint32_t, 5> smem_box_stride = {1,1,1,1,1};
      |                            ^~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp: In instantiation of ‘auto cute::detail::make_tma_copy_desc(const cute::Tensor<Engine, Layout>&, const cute::Layout<NewShape, NewStride>&, const cute::Swizzle<B1, M1, S1>&, uint32_t) [with TmaInternalType = cutlass::half_t; GEngine = cute::ViewEngine<cute::gmem_ptr<const cutlass::half_t*> >; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<cute::C<1>, long int, cute::C<0> > >; TShape = cute::tuple<cute::C<64>, cute::C<64> >; TStride = cute::tuple<cute::ScaledBasis<cute::C<1>, 0>, cute::ScaledBasis<cute::C<1>, 1> >; int B = 3; int M = 4; int S = 3; uint32_t = unsigned int]’:
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:1108:76:   required from ‘auto cute::detail::make_tma_copy_atom(CopyOp, const cute::Tensor<Engine, Layout>&, const SLayout&, const uint32_t&, const cute::Layout<NewShape, NewStride>&) [with TmaInternalType = cutlass::half_t; CopyOp = cute::SM90_TMA_LOAD; GEngine = cute::ViewEngine<cute::gmem_ptr<const cutlass::half_t*> >; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<cute::C<1>, long int, cute::C<0> > >; SLayout = cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::tuple<cute::C<64>, cute::C<2> >, cute::tuple<cute::C<8>, cute::C<8> > >, cute::tuple<cute::tuple<cute::C<1>, cute::C<4096> >, cute::tuple<cute::C<64>, cute::C<512> > > > >; VShape = cute::tuple<cute::C<128>, cute::C<64> >; VStride = cute::tuple<cute::ScaledBasis<cute::C<1>, 0>, cute::ScaledBasis<cute::C<1>, 1> >; uint32_t = unsigned int]’
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:1150:55:   required from ‘auto cute::detail::make_tma_copy_tiled(const CopyOp&, const cute::Tensor<Engine, Layout>&, const SLayout&, const cute::Layout<NewShape, NewStride>&, const cute::Layout<VShape, VStride>&) [with TmaInternalType = cutlass::half_t; CopyOp = cute::SM90_TMA_LOAD; GEngine = cute::ViewEngine<cute::gmem_ptr<const cutlass::half_t*> >; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<cute::C<1>, long int, cute::C<0> > >; SLayout = cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::tuple<cute::C<64>, cute::C<2> >, cute::tuple<cute::C<8>, cute::C<8> > >, cute::tuple<cute::tuple<cute::C<1>, cute::C<4096> >, cute::tuple<cute::C<64>, cute::C<512> > > > >; TShape = cute::C<1>; TStride = cute::C<0>; VShape = cute::tuple<cute::C<128>, cute::C<64> >; VStride = cute::tuple<cute::ScaledBasis<cute::C<1>, 0>, cute::ScaledBasis<cute::C<1>, 1> >]’
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:1286:48:   required from ‘auto cute::make_tma_copy(const CopyOp&, const cute::Tensor<Engine, Layout>&, const SLayout&, const CTA_Tiler&, const Cluster_Size&) [with TmaInternalType = void; CopyOp = cute::SM90_TMA_LOAD; GEngine = cute::ViewEngine<cute::gmem_ptr<const cutlass::half_t*> >; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<cute::C<1>, long int, cute::C<0> > >; SLayout = cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::tuple<cute::C<64>, cute::C<2> >, cute::tuple<cute::C<8>, cute::C<8> > >, cute::tuple<cute::tuple<cute::C<1>, cute::C<4096> >, cute::tuple<cute::C<64>, cute::C<512> > > > >; CTA_Tiler = cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >; Cluster_Size = cute::C<1>]’
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:248:41:   required from ‘struct cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >::Params’
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized.hpp:249:20:   required from ‘struct cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>::Params’
/home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:214:10:   required from ‘class cutlass::gemm::device::GemmUniversalAdapter<cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>, void>’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:160:9:   required from ‘at::Tensor run_grouped_gemm(const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<float, std::allocator<float> >&, const std::vector<float, std::allocator<float> >&, int) [with Gemm = cutlass::gemm::device::GemmUniversalAdapter<cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>, void>]’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:352:37:   required from here
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:908:9: warning: unused variable ‘gmem_address’ [-Wunused-variable]
  908 |   void* gmem_address = (void*) raw_pointer_cast(gtensor_T.data());
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:952:28: warning: unused variable ‘smem_box_stride’ [-Wunused-variable]
  952 |   cute::array<uint32_t, 5> smem_box_stride = {1,1,1,1,1};
      |                            ^~~~~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp: In instantiation of ‘auto cute::detail::make_tma_copy_desc(const cute::Tensor<Engine, Layout>&, const cute::Layout<NewShape, NewStride>&, const cute::Swizzle<B1, M1, S1>&, uint32_t) [with TmaInternalType = cutlass::half_t; GEngine = cute::ViewEngine<cute::gmem_ptr<cutlass::half_t*> >; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<cute::C<1>, long int, cute::C<0> > >; TShape = cute::tuple<cute::C<64>, cute::C<64> >; TStride = cute::tuple<cute::ScaledBasis<cute::C<1>, 0>, cute::ScaledBasis<cute::C<1>, 1> >; int B = 3; int M = 4; int S = 3; uint32_t = unsigned int]’:
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:1108:76:   required from ‘auto cute::detail::make_tma_copy_atom(CopyOp, const cute::Tensor<Engine, Layout>&, const SLayout&, const uint32_t&, const cute::Layout<NewShape, NewStride>&) [with TmaInternalType = cutlass::half_t; CopyOp = cute::SM90_TMA_STORE; GEngine = cute::ViewEngine<cute::gmem_ptr<cutlass::half_t*> >; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<cute::C<1>, long int, cute::C<0> > >; SLayout = cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::tuple<cute::C<64>, cute::C<2> >, cute::tuple<cute::C<8>, cute::C<8> > >, cute::tuple<cute::tuple<cute::C<1>, cute::C<4096> >, cute::tuple<cute::C<64>, cute::C<512> > > > >; VShape = cute::tuple<cute::C<128>, cute::C<64> >; VStride = cute::tuple<cute::ScaledBasis<cute::C<1>, 0>, cute::ScaledBasis<cute::C<1>, 1> >; uint32_t = unsigned int]’
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:1150:55:   required from ‘auto cute::detail::make_tma_copy_tiled(const CopyOp&, const cute::Tensor<Engine, Layout>&, const SLayout&, const cute::Layout<NewShape, NewStride>&, const cute::Layout<VShape, VStride>&) [with TmaInternalType = cutlass::half_t; CopyOp = cute::SM90_TMA_STORE; GEngine = cute::ViewEngine<cute::gmem_ptr<cutlass::half_t*> >; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<cute::C<1>, long int, cute::C<0> > >; SLayout = cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::tuple<cute::C<64>, cute::C<2> >, cute::tuple<cute::C<8>, cute::C<8> > >, cute::tuple<cute::tuple<cute::C<1>, cute::C<4096> >, cute::tuple<cute::C<64>, cute::C<512> > > > >; TShape = cute::C<1>; TStride = cute::C<0>; VShape = cute::tuple<cute::C<128>, cute::C<64> >; VStride = cute::tuple<cute::ScaledBasis<cute::C<1>, 0>, cute::ScaledBasis<cute::C<1>, 1> >]’
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:1286:48:   required from ‘auto cute::make_tma_copy(const CopyOp&, const cute::Tensor<Engine, Layout>&, const SLayout&, const CTA_Tiler&, const Cluster_Size&) [with TmaInternalType = void; CopyOp = cute::SM90_TMA_STORE; GEngine = cute::ViewEngine<cute::gmem_ptr<cutlass::half_t*> >; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<cute::C<1>, long int, cute::C<0> > >; SLayout = cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::tuple<cute::C<64>, cute::C<2> >, cute::tuple<cute::C<8>, cute::C<8> > >, cute::tuple<cute::tuple<cute::C<1>, cute::C<4096> >, cute::tuple<cute::C<64>, cute::C<512> > > > >; CTA_Tiler = cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >; Cluster_Size = cute::C<1>]’
/home/less/local/cutlass40/include/cutlass/epilogue/collective/sm100_epilogue_array_tma_warpspecialized.hpp:257:41:   required from ‘struct cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >::Params’
/home/less/local/cutlass40/include/cutlass/gemm/kernel/sm100_gemm_array_tma_warpspecialized.hpp:249:20:   required from ‘struct cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>::Params’
/home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:214:10:   required from ‘class cutlass::gemm::device::GemmUniversalAdapter<cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>, void>’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:160:9:   required from ‘at::Tensor run_grouped_gemm(const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<float, std::allocator<float> >&, const std::vector<float, std::allocator<float> >&, int) [with Gemm = cutlass::gemm::device::GemmUniversalAdapter<cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>, void>]’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:352:37:   required from here
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:908:9: warning: unused variable ‘gmem_address’ [-Wunused-variable]
  908 |   void* gmem_address = (void*) raw_pointer_cast(gtensor_T.data());
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:952:28: warning: unused variable ‘smem_box_stride’ [-Wunused-variable]
  952 |   cute::array<uint32_t, 5> smem_box_stride = {1,1,1,1,1};
      |                            ^~~~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp: In instantiation of ‘at::Tensor run_grouped_gemm(const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<float, std::allocator<float> >&, const std::vector<float, std::allocator<float> >&, int) [with Gemm = cutlass::gemm::device::GemmUniversalAdapter<cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<5, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<256>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_2x1SM_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<256>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM100_TMA_2SM_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM100_TMA_2SM_LOAD_MULTICAST, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>, void>]’:
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:352:37:   required from here
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:186:55: error: ‘stride_A’ was not declared in this scope; did you mean ‘StrideA’?
  186 |   cutlass::device_memory::allocation<StrideA> stride_A(groups);
      |                                               ~~~~~~~~^~~~~~~~
      |                                               StrideA
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:187:55: error: ‘stride_B’ was not declared in this scope; did you mean ‘StrideB’?
  187 |   cutlass::device_memory::allocation<StrideB> stride_B(groups);
      |                                               ~~~~~~~~^~~~~~~~
      |                                               StrideB
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:188:55: error: ‘stride_C’ was not declared in this scope; did you mean ‘StrideC’?
  188 |   cutlass::device_memory::allocation<StrideC> stride_C(groups);
      |                                               ~~~~~~~~^~~~~~~~
      |                                               StrideC
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:189:55: error: ‘stride_D’ was not declared in this scope; did you mean ‘StrideD’?
  189 |   cutlass::device_memory::allocation<StrideD> stride_D(groups);
      |                                               ~~~~~~~~^~~~~~~~
      |                                               StrideD
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:197:69: error: ‘block_alpha’ was not declared in this scope
  197 |   cutlass::device_memory::allocation<ElementAccumulator> block_alpha(groups);
      |                                                          ~~~~~~~~~~~^~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:198:68: error: ‘block_beta’ was not declared in this scope; did you mean ‘clock_t’?
  198 |   cutlass::device_memory::allocation<ElementAccumulator> block_beta(groups);
      |                                                          ~~~~~~~~~~^~~~~~~~
      |                                                          clock_t
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:216:72: error: ‘alpha_device’ was not declared in this scope
  216 |   cutlass::device_memory::allocation<ElementAccumulator *> alpha_device(groups);
      |                                                            ~~~~~~~~~~~~^~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:217:71: error: ‘beta_device’ was not declared in this scope
  217 |   cutlass::device_memory::allocation<ElementAccumulator *> beta_device(groups);
      |                                                            ~~~~~~~~~~~^~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:243:46: error: no type named ‘Arguments’ in ‘using EpilogueOutputOp = using ThreadEpilogueOp = using Operation = struct cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float>’ {aka ‘struct cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float>’}
  243 |   typename Gemm::EpilogueOutputOp::Arguments fusion_args{
      |                                              ^~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:243:46: error: no type named ‘Arguments’ in ‘using EpilogueOutputOp = using ThreadEpilogueOp = using Operation = struct cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float>’ {aka ‘struct cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float>’}
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:270:56: error: ‘workspace’ was not declared in this scope; did you mean ‘c10::attr::workspace’?
  270 |   cutlass::device_memory::allocation<uint8_t> workspace(workspace_size);
      |                                               ~~~~~~~~~^~~~~~~~~~~~~~~~
      |                                               c10::attr::workspace
In file included from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/ir/ir.h:18,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/method.h:7,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/object.h:5,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/module.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/serialize/input-archive.h:5,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/samplers/serialize.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/samplers.h:8,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/datasets/chunk.h:6,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/extension.h:5,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:3:
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/aten_interned_strings.h:2281:9: note: ‘c10::attr::workspace’ declared here
 2281 | _(attr, workspace) \
      |         ^~~~~~~~~
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/interned_strings.h:351:35: note: in definition of macro ‘DEFINE_SYMBOL’
  351 |   namespace ns { constexpr Symbol s(static_cast<unique_t>(_keys::ns##_##s)); }
      |                                   ^
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/interned_strings.h:298:3: note: in expansion of macro ‘FORALL_ATTR_BASE_SYMBOLS’
  298 |   FORALL_ATTR_BASE_SYMBOLS(_)        \
      |   ^~~~~~~~~~~~~~~~~~~~~~~~
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/interned_strings.h:352:1: note: in expansion of macro ‘FORALL_NS_SYMBOLS’
  352 | FORALL_NS_SYMBOLS(DEFINE_SYMBOL)
      | ^~~~~~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp: In instantiation of ‘at::Tensor run_grouped_gemm(const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<float, std::allocator<float> >&, const std::vector<float, std::allocator<float> >&, int) [with Gemm = cutlass::gemm::device::GemmUniversalAdapter<cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<3, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<128>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>, void>]’:
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:355:37:   required from here
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:133:20: error: ‘problem_sizes’ was not declared in this scope; did you mean ‘problem_sizes_host’?
  133 |       problem_sizes(groups);
      |       ~~~~~~~~~~~~~^~~~~~~~
      |       problem_sizes_host
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:152:55: error: ‘ptr_D’ was not declared in this scope
  152 |   cutlass::device_memory::allocation<ElementC *> ptr_D(groups);
      |                                                  ~~~~~^~~~~~~~
In file included from /home/less/local/cutlass40/include/cute/atom/copy_atom.hpp:756,
                 from /home/less/local/cutlass40/include/cute/algorithm/copy.hpp:36,
                 from /home/less/local/cutlass40/include/cute/tensor.hpp:51,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:8:
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp: In instantiation of ‘auto cute::detail::make_tma_copy_desc(const cute::Tensor<Engine, Layout>&, const cute::Layout<NewShape, NewStride>&, const cute::Swizzle<B1, M1, S1>&, uint32_t) [with TmaInternalType = cutlass::float_e4m3_t; GEngine = cute::ViewEngine<cutlass::float_e4m3_t*>; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<long int, cute::C<1>, cute::C<0> > >; TShape = cute::tuple<cute::C<128>, cute::C<256> >; TStride = cute::tuple<cute::ScaledBasis<cute::C<1>, 1>, cute::ScaledBasis<cute::C<1>, 0> >; int B = 3; int M = 4; int S = 3; uint32_t = unsigned int]’:
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:1108:76:   required from ‘auto cute::detail::make_tma_copy_atom(CopyOp, const cute::Tensor<Engine, Layout>&, const SLayout&, const uint32_t&, const cute::Layout<NewShape, NewStride>&) [with TmaInternalType = cutlass::float_e4m3_t; CopyOp = cute::SM90_TMA_LOAD; GEngine = cute::ViewEngine<cutlass::float_e4m3_t*>; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<long int, cute::C<1>, cute::C<0> > >; SLayout = cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::C<0>, cute::Layout<cute::tuple<cute::tuple<cute::C<256>, cute::C<32> >, cute::C<1>, cute::C<4> >, cute::tuple<cute::tuple<cute::C<128>, cute::C<1> >, cute::C<0>, cute::C<32> > > >; VShape = cute::tuple<cute::tuple<cute::C<256>, cute::C<32> >, cute::C<1>, cute::C<4> >; VStride = cute::tuple<cute::tuple<cute::ScaledBasis<cute::C<1>, 0>, cute::ScaledBasis<cute::C<1>, 1> >, cute::C<0>, cute::ScaledBasis<cute::C<32>, 1> >; uint32_t = unsigned int]’
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm100_tma.hpp:482:45:   required from ‘auto cute::make_tma_atom_B_sm100(const CopyOp&, const cute::Tensor<Engine, Layout>&, const SLayout&, const MMA_Tiler&, const cute::TiledMMA<Args ...>&, const ClusterShapeVMNK&) [with TmaInternalType = cutlass::float_e4m3_t; CopyOp = cute::SM90_TMA_LOAD; GEngine = cute::ViewEngine<cutlass::float_e4m3_t*>; GLayout = cute::Layout<cute::tuple<int, int, int>, cute::tuple<long int, cute::C<1>, cute::C<0> > >; SLayout = cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::C<0>, cute::Layout<cute::tuple<cute::tuple<cute::C<256>, cute::C<32> >, cute::C<1>, cute::C<4> >, cute::tuple<cute::tuple<cute::C<128>, cute::C<1> >, cute::C<0>, cute::C<32> > > >; MMA_Tiler = cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >; Args = {cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<128>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> >, cute::tuple<cute::C<0>, cute::C<0>, cute::C<0> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore>}; ClusterShapeVMNK = cute::Layout<cute::tuple<cute::tuple<cute::C<1> >, cute::C<1>, cute::C<1>, cute::C<1> >, cute::tuple<cute::tuple<cute::C<0> >, cute::C<0>, cute::C<0>, cute::C<0> > >]’
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized.hpp:275:70:   required from ‘struct cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<3, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<128>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>::Params’
/home/less/local/cutlass40/include/cutlass/gemm/collective/sm100_mma_array_warpspecialized.hpp:853:33:   required from ‘struct cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<3, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<128>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>’
/home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:618:97:   recursively required by substitution of ‘template<class GemmKernel> struct cutlass::gemm::detail::IsCutlass3GemmKernel<GemmKernel, std::void_t<typename GemmKernel::ProblemShape> > [with GemmKernel = cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<3, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<128>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>]’
/home/less/local/cutlass40/include/cutlass/gemm/device/gemm_universal_adapter.h:618:97:   required by substitution of ‘template<class GemmKernel_> class cutlass::gemm::device::GemmUniversalAdapter<GemmKernel_, typename std::enable_if<(! cutlass::gemm::detail::IsCutlass3GemmKernel<typename cutlass::GetUnderlyingKernel<T>::type>::value), void>::type> [with GemmKernel_ = cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<3, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<128>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>]’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:160:9:   required from ‘at::Tensor run_grouped_gemm(const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<float, std::allocator<float> >&, const std::vector<float, std::allocator<float> >&, int) [with Gemm = cutlass::gemm::device::GemmUniversalAdapter<cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<3, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<128>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>, void>]’
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:355:37:   required from here
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:908:9: warning: unused variable ‘gmem_address’ [-Wunused-variable]
  908 |   void* gmem_address = (void*) raw_pointer_cast(gtensor_T.data());
      |         ^~~~~~~~~~~~
/home/less/local/cutlass40/include/cute/atom/copy_traits_sm90_tma.hpp:952:28: warning: unused variable ‘smem_box_stride’ [-Wunused-variable]
  952 |   cute::array<uint32_t, 5> smem_box_stride = {1,1,1,1,1};
      |                            ^~~~~~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp: In instantiation of ‘at::Tensor run_grouped_gemm(const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<at::Tensor>&, const std::vector<float, std::allocator<float> >&, const std::vector<float, std::allocator<float> >&, int) [with Gemm = cutlass::gemm::device::GemmUniversalAdapter<cutlass::gemm::kernel::GemmUniversal<cutlass::gemm::GroupProblemShape<cute::tuple<int, int, int> >, cutlass::gemm::collective::CollectiveMma<cutlass::gemm::MainloopSm100ArrayTmaUmmaWarpSpecialized<3, 8, 2, cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cutlass::float_e4m3_t, cute::tuple<long int, cute::C<1>, cute::C<0> >*, cute::TiledMMA<cute::MMA_Atom<cute::MMA_Traits<cute::SM100_MMA_F8F6F4_SS, cutlass::float_e4m3_t, cutlass::float_e4m3_t, float, cute::C<128>, cute::C<256>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::Major, cute::UMMA::Major::K>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One>, cute::integral_constant<cute::UMMA::ScaleIn, cute::UMMA::ScaleIn::One> > >, cute::Layout<cute::tuple<cute::C<1>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<8>, cute::Layout<cute::tuple<cute::C<8>, cute::C<128> >, cute::tuple<cute::C<128>, cute::C<1> > > >, void, cute::identity>, cutlass::epilogue::collective::CollectiveEpilogue<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > >, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::half_t, cute::tuple<cute::C<1>, long int, cute::C<0> >*, cutlass::epilogue::fusion::FusionCallbacks<cutlass::epilogue::Sm100PtrArrayTmaWarpSpecialized<4, 2, 64, true, false>, cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float, cutlass::half_t, float, cutlass::FloatRoundStyle::round_to_nearest>, cute::tuple<cute::C<128>, cute::C<256>, cute::C<128> >, cute::tuple<cute::Layout<cute::C<128>, cute::C<1> >, cute::Layout<cute::C<64>, cute::C<1> > > >, cute::SM100::TMEM::LOAD::SM100_TMEM_LOAD_16dp256b8x, cute::SM90_TMA_LOAD, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM75_U16x8_LDSM_T, cute::SM90_TMA_STORE, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<16>, cute::Layout<cute::tuple<cute::C<64>, cute::C<8> >, cute::tuple<cute::C<1>, cute::C<64> > > >, cute::SM90_U16x8_STSM_T, cute::AutoVectorizingCopyWithAssumedAlignment<128> >, void, void>, void>]’:
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:355:37:   required from here
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:186:55: error: ‘stride_A’ was not declared in this scope; did you mean ‘StrideA’?
  186 |   cutlass::device_memory::allocation<StrideA> stride_A(groups);
      |                                               ~~~~~~~~^~~~~~~~
      |                                               StrideA
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:187:55: error: ‘stride_B’ was not declared in this scope; did you mean ‘StrideB’?
  187 |   cutlass::device_memory::allocation<StrideB> stride_B(groups);
      |                                               ~~~~~~~~^~~~~~~~
      |                                               StrideB
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:188:55: error: ‘stride_C’ was not declared in this scope; did you mean ‘StrideC’?
  188 |   cutlass::device_memory::allocation<StrideC> stride_C(groups);
      |                                               ~~~~~~~~^~~~~~~~
      |                                               StrideC
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:189:55: error: ‘stride_D’ was not declared in this scope; did you mean ‘StrideD’?
  189 |   cutlass::device_memory::allocation<StrideD> stride_D(groups);
      |                                               ~~~~~~~~^~~~~~~~
      |                                               StrideD
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:197:69: error: ‘block_alpha’ was not declared in this scope
  197 |   cutlass::device_memory::allocation<ElementAccumulator> block_alpha(groups);
      |                                                          ~~~~~~~~~~~^~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:198:68: error: ‘block_beta’ was not declared in this scope; did you mean ‘clock_t’?
  198 |   cutlass::device_memory::allocation<ElementAccumulator> block_beta(groups);
      |                                                          ~~~~~~~~~~^~~~~~~~
      |                                                          clock_t
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:216:72: error: ‘alpha_device’ was not declared in this scope
  216 |   cutlass::device_memory::allocation<ElementAccumulator *> alpha_device(groups);
      |                                                            ~~~~~~~~~~~~^~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:217:71: error: ‘beta_device’ was not declared in this scope
  217 |   cutlass::device_memory::allocation<ElementAccumulator *> beta_device(groups);
      |                                                            ~~~~~~~~~~~^~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:243:46: error: no type named ‘Arguments’ in ‘using EpilogueOutputOp = using ThreadEpilogueOp = using Operation = struct cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float>’ {aka ‘struct cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float>’}
  243 |   typename Gemm::EpilogueOutputOp::Arguments fusion_args{
      |                                              ^~~~~~~~~~~
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:243:46: error: no type named ‘Arguments’ in ‘using EpilogueOutputOp = using ThreadEpilogueOp = using Operation = struct cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float>’ {aka ‘struct cutlass::epilogue::fusion::LinearCombination<cutlass::half_t, float>’}
/data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:270:56: error: ‘workspace’ was not declared in this scope; did you mean ‘c10::attr::workspace’?
  270 |   cutlass::device_memory::allocation<uint8_t> workspace(workspace_size);
      |                                               ~~~~~~~~~^~~~~~~~~~~~~~~~
      |                                               c10::attr::workspace
In file included from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/ir/ir.h:18,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/method.h:7,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/object.h:5,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/jit/api/module.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/serialize/input-archive.h:5,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/samplers/serialize.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/samplers.h:8,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/datasets/chunk.h:6,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                 from /home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/torch/extension.h:5,
                 from /data/users/less/torchtitan/torchtitan/experiments/kernels/moe/blackwell_fp8_group_gemm/c4_grouped_gemm.cpp:3:
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/aten_interned_strings.h:2281:9: note: ‘c10::attr::workspace’ declared here
 2281 | _(attr, workspace) \
      |         ^~~~~~~~~
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/interned_strings.h:351:35: note: in definition of macro ‘DEFINE_SYMBOL’
  351 |   namespace ns { constexpr Symbol s(static_cast<unique_t>(_keys::ns##_##s)); }
      |                                   ^
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/interned_strings.h:298:3: note: in expansion of macro ‘FORALL_ATTR_BASE_SYMBOLS’
  298 |   FORALL_ATTR_BASE_SYMBOLS(_)        \
      |   ^~~~~~~~~~~~~~~~~~~~~~~~
/home/less/.conda/envs/pycutlass/lib/python3.12/site-packages/torch/include/ATen/core/interned_strings.h:352:1: note: in expansion of macro ‘FORALL_NS_SYMBOLS’
  352 | FORALL_NS_SYMBOLS(DEFINE_SYMBOL)
      | ^~~~~~~~~~~~~~~~~
ninja: build stopped: subcommand failed.
